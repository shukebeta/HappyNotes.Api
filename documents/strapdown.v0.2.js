<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>strapdown/v/0.2/strapdown.js - third_party/lz4 - Git at Google</title><link rel="stylesheet" type="text/css" href="/+static/base.css"><link rel="stylesheet" type="text/css" href="/+static/prettify/prettify.css"><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header"><div class="Header"><a class="Header-image" href="/"><img src="//www.gstatic.com/images/branding/lockups/2x/lockup_git_color_108x24dp.png" width="108" height="24" alt="Google Git"></a><div class="Header-menu"> <a class="Header-menuItem" href="https://accounts.google.com/AccountChooser?faa=1&amp;service=gerritcodereview&amp;continue=https://fuchsia.googlesource.com/login/third_party/lz4/%2B/refs/heads/upstream/gh-pages/strapdown/v/0.2/strapdown.js">Sign in</a> </div></div></header><div class="Site-content"><div class="Container "><div class="Breadcrumbs"><a class="Breadcrumbs-crumb" href="/?format=HTML">fuchsia</a> / <a class="Breadcrumbs-crumb" href="/third_party/">third_party</a> / <a class="Breadcrumbs-crumb" href="/third_party/lz4/">lz4</a> / <a class="Breadcrumbs-crumb" href="/third_party/lz4/+/refs/heads/upstream/gh-pages">refs/heads/upstream/gh-pages</a> / <a class="Breadcrumbs-crumb" href="/third_party/lz4/+/refs/heads/upstream/gh-pages/">.</a> / <a class="Breadcrumbs-crumb" href="/third_party/lz4/+/refs/heads/upstream/gh-pages/strapdown?autodive=0">strapdown</a> / <a class="Breadcrumbs-crumb" href="/third_party/lz4/+/refs/heads/upstream/gh-pages/strapdown/v?autodive=0">v</a> / <a class="Breadcrumbs-crumb" href="/third_party/lz4/+/refs/heads/upstream/gh-pages/strapdown/v/0.2">0.2</a> / <span class="Breadcrumbs-crumb">strapdown.js</span></div><div class="u-sha1 u-monospace BlobSha1">blob: ecef869e916836bfaf055b5501fe78ce47d2a538 [<a href="/third_party/lz4/+/refs/heads/upstream/gh-pages/strapdown/v/0.2/strapdown.js">file</a>] [<a href="/third_party/lz4/+log/refs/heads/upstream/gh-pages/strapdown/v/0.2/strapdown.js">log</a>] [<a href="/third_party/lz4/+blame/refs/heads/upstream/gh-pages/strapdown/v/0.2/strapdown.js">blame</a>]</div><table class="FileContents"><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="1"></td><td class="FileContents-lineContents" id="1"><span class="com">/**</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="2"></td><td class="FileContents-lineContents" id="2"><span class="com"> * marked - a markdown parser</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="3"></td><td class="FileContents-lineContents" id="3"><span class="com"> * Copyright (c) 2011-2013, Christopher Jeffrey. (MIT Licensed)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="4"></td><td class="FileContents-lineContents" id="4"><span class="com"> * https://github.com/chjj/marked</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="5"></td><td class="FileContents-lineContents" id="5"><span class="com"> */</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="6"></td><td class="FileContents-lineContents" id="6"><span class="pun">;(</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">var</span><span class="pln"> block</span><span class="pun">={</span><span class="pln">newline</span><span class="pun">:</span><span class="str">/^\n+/</span><span class="pun">,</span><span class="pln">code</span><span class="pun">:</span><span class="str">/^( {4}[^\n]+\n*)+/</span><span class="pun">,</span><span class="pln">fences</span><span class="pun">:</span><span class="pln">noop</span><span class="pun">,</span><span class="pln">hr</span><span class="pun">:</span><span class="str">/^( *[-*_]){3,} *(?:\n+|$)/</span><span class="pun">,</span><span class="pln">heading</span><span class="pun">:</span><span class="str">/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/</span><span class="pun">,</span><span class="pln">nptable</span><span class="pun">:</span><span class="pln">noop</span><span class="pun">,</span><span class="pln">lheading</span><span class="pun">:</span><span class="str">/^([^\n]+)\n *(=|-){3,} *\n*/</span><span class="pun">,</span><span class="pln">blockquote</span><span class="pun">:</span><span class="str">/^( *&gt;[^\n]+(\n[^\n]+)*\n*)+/</span><span class="pun">,</span><span class="pln">list</span><span class="pun">:</span><span class="str">/^( *)(bull) [\s\S]+?(?:hr|\n{2,}(?! )(?!\1bull )\n*|\s*$)/</span><span class="pun">,</span><span class="pln">html</span><span class="pun">:</span><span class="str">/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/</span><span class="pun">,</span><span class="pln">def</span><span class="pun">:</span><span class="str">/^ *\[([^\]]+)\]: *&lt;?([^\s&gt;]+)&gt;?(?: +[&quot;(]([^\n]+)[&quot;)])? *(?:\n+|$)/</span><span class="pun">,</span><span class="pln">table</span><span class="pun">:</span><span class="pln">noop</span><span class="pun">,</span><span class="pln">paragraph</span><span class="pun">:</span><span class="str">/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/</span><span class="pun">,</span><span class="pln">text</span><span class="pun">:</span><span class="str">/^[^\n]+/</span><span class="pun">};</span><span class="pln">block</span><span class="pun">.</span><span class="pln">bullet</span><span class="pun">=</span><span class="str">/(?:[*+-]|\d+\.)/</span><span class="pun">;</span><span class="pln">block</span><span class="pun">.</span><span class="pln">item</span><span class="pun">=</span><span class="str">/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/</span><span class="pun">;</span><span class="pln">block</span><span class="pun">.</span><span class="pln">item</span><span class="pun">=</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">block</span><span class="pun">.</span><span class="pln">item</span><span class="pun">,</span><span class="str">&#39;gm&#39;</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="7"></td><td class="FileContents-lineContents" id="7"><span class="pun">(</span><span class="str">/bull/</span><span class="pln">g</span><span class="pun">,</span><span class="pln">block</span><span class="pun">.</span><span class="pln">bullet</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="8"></td><td class="FileContents-lineContents" id="8"><span class="pun">();</span><span class="pln">block</span><span class="pun">.</span><span class="pln">list</span><span class="pun">=</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">block</span><span class="pun">.</span><span class="pln">list</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="9"></td><td class="FileContents-lineContents" id="9"><span class="pun">(</span><span class="str">/bull/</span><span class="pln">g</span><span class="pun">,</span><span class="pln">block</span><span class="pun">.</span><span class="pln">bullet</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="10"></td><td class="FileContents-lineContents" id="10"><span class="pun">(</span><span class="str">&#39;hr&#39;</span><span class="pun">,</span><span class="str">/\n+(?=(?: *[-*_]){3,} *(?:\n+|$))/</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="11"></td><td class="FileContents-lineContents" id="11"><span class="pun">();</span><span class="pln">block</span><span class="pun">.</span><span class="pln">_tag</span><span class="pun">=</span><span class="str">&#39;(?!(?:&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="12"></td><td class="FileContents-lineContents" id="12"><span class="pun">+</span><span class="str">&#39;a|em|strong|small|s|cite|q|dfn|abbr|data|time|code&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="13"></td><td class="FileContents-lineContents" id="13"><span class="pun">+</span><span class="str">&#39;|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="14"></td><td class="FileContents-lineContents" id="14"><span class="pun">+</span><span class="str">&#39;|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|@)\\b&#39;</span><span class="pun">;</span><span class="pln">block</span><span class="pun">.</span><span class="pln">html</span><span class="pun">=</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">block</span><span class="pun">.</span><span class="pln">html</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="15"></td><td class="FileContents-lineContents" id="15"><span class="pun">(</span><span class="str">&#39;comment&#39;</span><span class="pun">,</span><span class="str">/&lt;!--[\s\S]*?--&gt;/</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="16"></td><td class="FileContents-lineContents" id="16"><span class="pun">(</span><span class="str">&#39;closed&#39;</span><span class="pun">,</span><span class="str">/&lt;(tag)[\s\S]+?&lt;\/\1&gt;/</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="17"></td><td class="FileContents-lineContents" id="17"><span class="pun">(</span><span class="str">&#39;closing&#39;</span><span class="pun">,</span><span class="str">/&lt;tag(?:&quot;[^&quot;]*&quot;|&#39;[^&#39;]*&#39;|[^&#39;&quot;&gt;])*?&gt;/</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="18"></td><td class="FileContents-lineContents" id="18"><span class="pun">(</span><span class="str">/tag/</span><span class="pln">g</span><span class="pun">,</span><span class="pln">block</span><span class="pun">.</span><span class="pln">_tag</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="19"></td><td class="FileContents-lineContents" id="19"><span class="pun">();</span><span class="pln">block</span><span class="pun">.</span><span class="pln">paragraph</span><span class="pun">=</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">block</span><span class="pun">.</span><span class="pln">paragraph</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="20"></td><td class="FileContents-lineContents" id="20"><span class="pun">(</span><span class="str">&#39;hr&#39;</span><span class="pun">,</span><span class="pln">block</span><span class="pun">.</span><span class="pln">hr</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="21"></td><td class="FileContents-lineContents" id="21"><span class="pun">(</span><span class="str">&#39;heading&#39;</span><span class="pun">,</span><span class="pln">block</span><span class="pun">.</span><span class="pln">heading</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="22"></td><td class="FileContents-lineContents" id="22"><span class="pun">(</span><span class="str">&#39;lheading&#39;</span><span class="pun">,</span><span class="pln">block</span><span class="pun">.</span><span class="pln">lheading</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="23"></td><td class="FileContents-lineContents" id="23"><span class="pun">(</span><span class="str">&#39;blockquote&#39;</span><span class="pun">,</span><span class="pln">block</span><span class="pun">.</span><span class="pln">blockquote</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="24"></td><td class="FileContents-lineContents" id="24"><span class="pun">(</span><span class="str">&#39;tag&#39;</span><span class="pun">,</span><span class="str">&#39;&lt;&#39;</span><span class="pun">+</span><span class="pln">block</span><span class="pun">.</span><span class="pln">_tag</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="25"></td><td class="FileContents-lineContents" id="25"><span class="pun">(</span><span class="str">&#39;def&#39;</span><span class="pun">,</span><span class="pln">block</span><span class="pun">.</span><span class="pln">def</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="26"></td><td class="FileContents-lineContents" id="26"><span class="pun">();</span><span class="pln">block</span><span class="pun">.</span><span class="pln">normal</span><span class="pun">=</span><span class="pln">merge</span><span class="pun">({},</span><span class="pln">block</span><span class="pun">);</span><span class="pln">block</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">=</span><span class="pln">merge</span><span class="pun">({},</span><span class="pln">block</span><span class="pun">.</span><span class="pln">normal</span><span class="pun">,{</span><span class="pln">fences</span><span class="pun">:</span><span class="str">/^ *(`{3,}|~{3,}) *(\w+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/</span><span class="pun">,</span><span class="pln">paragraph</span><span class="pun">:</span><span class="str">/^/</span><span class="pun">});</span><span class="pln">block</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">.</span><span class="pln">paragraph</span><span class="pun">=</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">block</span><span class="pun">.</span><span class="pln">paragraph</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="27"></td><td class="FileContents-lineContents" id="27"><span class="pun">(</span><span class="str">&#39;(?!&#39;</span><span class="pun">,</span><span class="str">&#39;(?!&#39;</span><span class="pun">+</span><span class="pln">block</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">.</span><span class="pln">fences</span><span class="pun">.</span><span class="pln">source</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">&#39;\\1&#39;</span><span class="pun">,</span><span class="str">&#39;\\2&#39;</span><span class="pun">)+</span><span class="str">&#39;|&#39;</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="28"></td><td class="FileContents-lineContents" id="28"><span class="pun">();</span><span class="pln">block</span><span class="pun">.</span><span class="pln">tables</span><span class="pun">=</span><span class="pln">merge</span><span class="pun">({},</span><span class="pln">block</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">,{</span><span class="pln">nptable</span><span class="pun">:</span><span class="str">/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/</span><span class="pun">,</span><span class="pln">table</span><span class="pun">:</span><span class="str">/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/</span><span class="pun">});</span><span class="kwd">function</span><span class="pln"> </span><span class="typ">Lexer</span><span class="pun">(</span><span class="pln">options</span><span class="pun">){</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">=[];</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">links</span><span class="pun">={};</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">=</span><span class="pln">options</span><span class="pun">||</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">defaults</span><span class="pun">;</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">=</span><span class="pln">block</span><span class="pun">.</span><span class="pln">normal</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">tables</span><span class="pun">){</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">=</span><span class="pln">block</span><span class="pun">.</span><span class="pln">tables</span><span class="pun">;}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">=</span><span class="pln">block</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">;}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="29"></td><td class="FileContents-lineContents" id="29"><span class="typ">Lexer</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">=</span><span class="pln">block</span><span class="pun">;</span><span class="typ">Lexer</span><span class="pun">.</span><span class="pln">lex</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">src</span><span class="pun">,</span><span class="pln">options</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> lexer</span><span class="pun">=</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Lexer</span><span class="pun">(</span><span class="pln">options</span><span class="pun">);</span><span class="kwd">return</span><span class="pln"> lexer</span><span class="pun">.</span><span class="pln">lex</span><span class="pun">(</span><span class="pln">src</span><span class="pun">);};</span><span class="typ">Lexer</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">lex</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">src</span><span class="pun">){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/\r\n|\r/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;\n&#39;</span><span class="pun">).</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/\t/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;    &#39;</span><span class="pun">).</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/\u00a0/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39; &#39;</span><span class="pun">).</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/\u2424/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;\n&#39;</span><span class="pun">);</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">(</span><span class="pln">src</span><span class="pun">,</span><span class="kwd">true</span><span class="pun">);};</span><span class="typ">Lexer</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">token</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">src</span><span class="pun">,</span><span class="pln">top</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ +$/</span><span class="pln">gm</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">),</span><span class="pln">next</span><span class="pun">,</span><span class="pln">loose</span><span class="pun">,</span><span class="pln">cap</span><span class="pun">,</span><span class="pln">bull</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">item</span><span class="pun">,</span><span class="pln">space</span><span class="pun">,</span><span class="pln">i</span><span class="pun">,</span><span class="pln">l</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">src</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">newline</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">){</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;space&#39;</span><span class="pun">});}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="30"></td><td class="FileContents-lineContents" id="30"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">code</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">cap</span><span class="pun">=</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ {4}/</span><span class="pln">gm</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;code&#39;</span><span class="pun">,</span><span class="pln">text</span><span class="pun">:!</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">pedantic</span><span class="pun">?</span><span class="pln">cap</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/\n+$/</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">):</span><span class="pln">cap</span><span class="pun">});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="31"></td><td class="FileContents-lineContents" id="31"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">fences</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;code&#39;</span><span class="pun">,</span><span class="pln">lang</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">],</span><span class="pln">text</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="32"></td><td class="FileContents-lineContents" id="32"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">heading</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;heading&#39;</span><span class="pun">,</span><span class="pln">depth</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">length</span><span class="pun">,</span><span class="pln">text</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="33"></td><td class="FileContents-lineContents" id="33"><span class="kwd">if</span><span class="pun">(</span><span class="pln">top</span><span class="pun">&amp;&amp;(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">nptable</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">))){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">item</span><span class="pun">={</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;table&#39;</span><span class="pun">,</span><span class="pln">header</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ *| *\| *$/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">).</span><span class="pln">split</span><span class="pun">(</span><span class="str">/ *\| */</span><span class="pun">),</span><span class="pln">align</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ *|\| *$/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">).</span><span class="pln">split</span><span class="pun">(</span><span class="str">/ *\| */</span><span class="pun">),</span><span class="pln">cells</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">3</span><span class="pun">].</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/\n$/</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">).</span><span class="pln">split</span><span class="pun">(</span><span class="str">&#39;\n&#39;</span><span class="pun">)};</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="kwd">if</span><span class="pun">(</span><span class="str">/^ *-+: *$/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])){</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">&#39;right&#39;</span><span class="pun">;}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="str">/^ *:-+: *$/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])){</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">&#39;center&#39;</span><span class="pun">;}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="str">/^ *:-+ *$/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])){</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">&#39;left&#39;</span><span class="pun">;}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="kwd">null</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="34"></td><td class="FileContents-lineContents" id="34"><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">item</span><span class="pun">.</span><span class="pln">cells</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">item</span><span class="pun">.</span><span class="pln">cells</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">item</span><span class="pun">.</span><span class="pln">cells</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">split</span><span class="pun">(</span><span class="str">/ *\| */</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="35"></td><td class="FileContents-lineContents" id="35"><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">item</span><span class="pun">);</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="36"></td><td class="FileContents-lineContents" id="36"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">lheading</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;heading&#39;</span><span class="pun">,</span><span class="pln">depth</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]===</span><span class="str">&#39;=&#39;</span><span class="pun">?</span><span class="lit">1</span><span class="pun">:</span><span class="lit">2</span><span class="pun">,</span><span class="pln">text</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="37"></td><td class="FileContents-lineContents" id="37"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">hr</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;hr&#39;</span><span class="pun">});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="38"></td><td class="FileContents-lineContents" id="38"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">blockquote</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;blockquote_start&#39;</span><span class="pun">});</span><span class="pln">cap</span><span class="pun">=</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ *&gt; ?/</span><span class="pln">gm</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">,</span><span class="pln">top</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;blockquote_end&#39;</span><span class="pun">});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="39"></td><td class="FileContents-lineContents" id="39"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">list</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;list_start&#39;</span><span class="pun">,</span><span class="pln">ordered</span><span class="pun">:</span><span class="pln">isFinite</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">])});</span><span class="pln">cap</span><span class="pun">=</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">match</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">item</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">smartLists</span><span class="pun">){</span><span class="pln">bull</span><span class="pun">=</span><span class="pln">block</span><span class="pun">.</span><span class="pln">bullet</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">];}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="40"></td><td class="FileContents-lineContents" id="40"><span class="pln">next</span><span class="pun">=</span><span class="kwd">false</span><span class="pun">;</span><span class="pln">l</span><span class="pun">=</span><span class="pln">cap</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">l</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">item</span><span class="pun">=</span><span class="pln">cap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">space</span><span class="pun">=</span><span class="pln">item</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">item</span><span class="pun">=</span><span class="pln">item</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ *([*+-]|\d+\.) +/</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(~</span><span class="pln">item</span><span class="pun">.</span><span class="pln">indexOf</span><span class="pun">(</span><span class="str">&#39;\n &#39;</span><span class="pun">)){</span><span class="pln">space</span><span class="pun">-=</span><span class="pln">item</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">item</span><span class="pun">=!</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">pedantic</span><span class="pun">?</span><span class="pln">item</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="str">&#39;^ {1,&#39;</span><span class="pun">+</span><span class="pln">space</span><span class="pun">+</span><span class="str">&#39;}&#39;</span><span class="pun">,</span><span class="str">&#39;gm&#39;</span><span class="pun">),</span><span class="str">&#39;&#39;</span><span class="pun">):</span><span class="pln">item</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ {1,4}/</span><span class="pln">gm</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="41"></td><td class="FileContents-lineContents" id="41"><span class="kwd">if</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">smartLists</span><span class="pun">&amp;&amp;</span><span class="pln">i</span><span class="pun">!==</span><span class="pln">l</span><span class="pun">-</span><span class="lit">1</span><span class="pun">){</span><span class="pln">b</span><span class="pun">=</span><span class="pln">block</span><span class="pun">.</span><span class="pln">bullet</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bull</span><span class="pun">!==</span><span class="pln">b</span><span class="pun">&amp;&amp;!(</span><span class="pln">bull</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]===</span><span class="str">&#39;.&#39;</span><span class="pun">&amp;&amp;</span><span class="pln">b</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]===</span><span class="str">&#39;.&#39;</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">cap</span><span class="pun">.</span><span class="pln">slice</span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">).</span><span class="pln">join</span><span class="pun">(</span><span class="str">&#39;\n&#39;</span><span class="pun">)+</span><span class="pln">src</span><span class="pun">;</span><span class="pln">i</span><span class="pun">=</span><span class="pln">l</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="42"></td><td class="FileContents-lineContents" id="42"><span class="pln">loose</span><span class="pun">=</span><span class="pln">next</span><span class="pun">||</span><span class="str">/\n\n(?!\s*$)/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">item</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">!==</span><span class="pln">l</span><span class="pun">-</span><span class="lit">1</span><span class="pun">){</span><span class="pln">next</span><span class="pun">=</span><span class="pln">item</span><span class="pun">[</span><span class="pln">item</span><span class="pun">.</span><span class="pln">length</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]===</span><span class="str">&#39;\n&#39;</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">loose</span><span class="pun">)</span><span class="pln">loose</span><span class="pun">=</span><span class="pln">next</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="43"></td><td class="FileContents-lineContents" id="43"><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="pln">loose</span><span class="pun">?</span><span class="str">&#39;loose_item_start&#39;</span><span class="pun">:</span><span class="str">&#39;list_item_start&#39;</span><span class="pun">});</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">(</span><span class="pln">item</span><span class="pun">,</span><span class="kwd">false</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;list_item_end&#39;</span><span class="pun">});}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="44"></td><td class="FileContents-lineContents" id="44"><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;list_end&#39;</span><span class="pun">});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="45"></td><td class="FileContents-lineContents" id="45"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">html</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">sanitize</span><span class="pun">?</span><span class="str">&#39;paragraph&#39;</span><span class="pun">:</span><span class="str">&#39;html&#39;</span><span class="pun">,</span><span class="pln">pre</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]===</span><span class="str">&#39;pre&#39;</span><span class="pun">,</span><span class="pln">text</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="46"></td><td class="FileContents-lineContents" id="46"><span class="kwd">if</span><span class="pun">(</span><span class="pln">top</span><span class="pun">&amp;&amp;(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">def</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">))){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">links</span><span class="pun">[</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">toLowerCase</span><span class="pun">()]={</span><span class="pln">href</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">],</span><span class="pln">title</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]};</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="47"></td><td class="FileContents-lineContents" id="47"><span class="kwd">if</span><span class="pun">(</span><span class="pln">top</span><span class="pun">&amp;&amp;(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">table</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">))){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">item</span><span class="pun">={</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;table&#39;</span><span class="pun">,</span><span class="pln">header</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ *| *\| *$/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">).</span><span class="pln">split</span><span class="pun">(</span><span class="str">/ *\| */</span><span class="pun">),</span><span class="pln">align</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ *|\| *$/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">).</span><span class="pln">split</span><span class="pun">(</span><span class="str">/ *\| */</span><span class="pun">),</span><span class="pln">cells</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">3</span><span class="pun">].</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/(?: *\| *)?\n$/</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">).</span><span class="pln">split</span><span class="pun">(</span><span class="str">&#39;\n&#39;</span><span class="pun">)};</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="kwd">if</span><span class="pun">(</span><span class="str">/^ *-+: *$/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])){</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">&#39;right&#39;</span><span class="pun">;}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="str">/^ *:-+: *$/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])){</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">&#39;center&#39;</span><span class="pun">;}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="str">/^ *:-+ *$/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])){</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">&#39;left&#39;</span><span class="pun">;}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">item</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="kwd">null</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="48"></td><td class="FileContents-lineContents" id="48"><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">item</span><span class="pun">.</span><span class="pln">cells</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">item</span><span class="pun">.</span><span class="pln">cells</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">item</span><span class="pun">.</span><span class="pln">cells</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ *\| *| *\| *$/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">).</span><span class="pln">split</span><span class="pun">(</span><span class="str">/ *\| */</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="49"></td><td class="FileContents-lineContents" id="49"><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">item</span><span class="pun">);</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="50"></td><td class="FileContents-lineContents" id="50"><span class="kwd">if</span><span class="pun">(</span><span class="pln">top</span><span class="pun">&amp;&amp;(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">paragraph</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">))){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;paragraph&#39;</span><span class="pun">,</span><span class="pln">text</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">length</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]===</span><span class="str">&#39;\n&#39;</span><span class="pun">?</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">slice</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,-</span><span class="lit">1</span><span class="pun">):</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="51"></td><td class="FileContents-lineContents" id="51"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">text</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">push</span><span class="pun">({</span><span class="pln">type</span><span class="pun">:</span><span class="str">&#39;text&#39;</span><span class="pun">,</span><span class="pln">text</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="52"></td><td class="FileContents-lineContents" id="52"><span class="kwd">if</span><span class="pun">(</span><span class="pln">src</span><span class="pun">){</span><span class="kwd">throw</span><span class="pln"> </span><span class="kwd">new</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="53"></td><td class="FileContents-lineContents" id="53"><span class="typ">Error</span><span class="pun">(</span><span class="str">&#39;Infinite loop on byte: &#39;</span><span class="pun">+</span><span class="pln">src</span><span class="pun">.</span><span class="pln">charCodeAt</span><span class="pun">(</span><span class="lit">0</span><span class="pun">));}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="54"></td><td class="FileContents-lineContents" id="54"><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">;};</span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">inline</span><span class="pun">={</span><span class="pln">escape</span><span class="pun">:</span><span class="str">/^\\([\\`*{}\[\]()#+\-.!_&gt;])/</span><span class="pun">,</span><span class="pln">autolink</span><span class="pun">:</span><span class="str">/^&lt;([^ &gt;]+(@|:\/)[^ &gt;]+)&gt;/</span><span class="pun">,</span><span class="pln">url</span><span class="pun">:</span><span class="pln">noop</span><span class="pun">,</span><span class="pln">tag</span><span class="pun">:</span><span class="str">/^&lt;!--[\s\S]*?--&gt;|^&lt;\/?\w+(?:&quot;[^&quot;]*&quot;|&#39;[^&#39;]*&#39;|[^&#39;&quot;&gt;])*?&gt;/</span><span class="pun">,</span><span class="pln">link</span><span class="pun">:</span><span class="str">/^!?\[(inside)\]\(href\)/</span><span class="pun">,</span><span class="pln">reflink</span><span class="pun">:</span><span class="str">/^!?\[(inside)\]\s*\[([^\]]*)\]/</span><span class="pun">,</span><span class="pln">nolink</span><span class="pun">:</span><span class="str">/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/</span><span class="pun">,</span><span class="pln">strong</span><span class="pun">:</span><span class="str">/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/</span><span class="pun">,</span><span class="pln">em</span><span class="pun">:</span><span class="str">/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/</span><span class="pun">,</span><span class="pln">code</span><span class="pun">:</span><span class="str">/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/</span><span class="pun">,</span><span class="pln">br</span><span class="pun">:</span><span class="str">/^ {2,}\n(?!\s*$)/</span><span class="pun">,</span><span class="pln">del</span><span class="pun">:</span><span class="pln">noop</span><span class="pun">,</span><span class="pln">text</span><span class="pun">:</span><span class="str">/^[\s\S]+?(?=[\\&lt;!\[_*`]| {2,}\n|$)/</span><span class="pun">};</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">_inside</span><span class="pun">=</span><span class="str">/(?:\[[^\]]*\]|[^\]]|\](?=[^\[]*\]))*/</span><span class="pun">;</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">_href</span><span class="pun">=</span><span class="str">/\s*&lt;?([^\s]*?)&gt;?(?:\s+[&#39;&quot;]([\s\S]*?)[&#39;&quot;])?\s*/</span><span class="pun">;</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">link</span><span class="pun">=</span><span class="pln">replace</span><span class="pun">(</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">link</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="55"></td><td class="FileContents-lineContents" id="55"><span class="pun">(</span><span class="str">&#39;inside&#39;</span><span class="pun">,</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">_inside</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="56"></td><td class="FileContents-lineContents" id="56"><span class="pun">(</span><span class="str">&#39;href&#39;</span><span class="pun">,</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">_href</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="57"></td><td class="FileContents-lineContents" id="57"><span class="pun">();</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">reflink</span><span class="pun">=</span><span class="pln">replace</span><span class="pun">(</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">reflink</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="58"></td><td class="FileContents-lineContents" id="58"><span class="pun">(</span><span class="str">&#39;inside&#39;</span><span class="pun">,</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">_inside</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="59"></td><td class="FileContents-lineContents" id="59"><span class="pun">();</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">normal</span><span class="pun">=</span><span class="pln">merge</span><span class="pun">({},</span><span class="kwd">inline</span><span class="pun">);</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">pedantic</span><span class="pun">=</span><span class="pln">merge</span><span class="pun">({},</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">normal</span><span class="pun">,{</span><span class="pln">strong</span><span class="pun">:</span><span class="str">/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/</span><span class="pun">,</span><span class="pln">em</span><span class="pun">:</span><span class="str">/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/</span><span class="pun">});</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">=</span><span class="pln">merge</span><span class="pun">({},</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">normal</span><span class="pun">,{</span><span class="pln">escape</span><span class="pun">:</span><span class="pln">replace</span><span class="pun">(</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">escape</span><span class="pun">)(</span><span class="str">&#39;])&#39;</span><span class="pun">,</span><span class="str">&#39;~|])&#39;</span><span class="pun">)(),</span><span class="pln">url</span><span class="pun">:</span><span class="str">/^(https?:\/\/[^\s&lt;]+[^&lt;.,:;&quot;&#39;)\]\s])/</span><span class="pun">,</span><span class="pln">del</span><span class="pun">:</span><span class="str">/^~~(?=\S)([\s\S]*?\S)~~/</span><span class="pun">,</span><span class="pln">text</span><span class="pun">:</span><span class="pln">replace</span><span class="pun">(</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">text</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="60"></td><td class="FileContents-lineContents" id="60"><span class="pun">(</span><span class="str">&#39;]|&#39;</span><span class="pun">,</span><span class="str">&#39;~]|&#39;</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="61"></td><td class="FileContents-lineContents" id="61"><span class="pun">(</span><span class="str">&#39;|&#39;</span><span class="pun">,</span><span class="str">&#39;|https?://|&#39;</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="62"></td><td class="FileContents-lineContents" id="62"><span class="pun">()});</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">breaks</span><span class="pun">=</span><span class="pln">merge</span><span class="pun">({},</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">,{</span><span class="pln">br</span><span class="pun">:</span><span class="pln">replace</span><span class="pun">(</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">br</span><span class="pun">)(</span><span class="str">&#39;{2,}&#39;</span><span class="pun">,</span><span class="str">&#39;*&#39;</span><span class="pun">)(),</span><span class="pln">text</span><span class="pun">:</span><span class="pln">replace</span><span class="pun">(</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">.</span><span class="pln">text</span><span class="pun">)(</span><span class="str">&#39;{2,}&#39;</span><span class="pun">,</span><span class="str">&#39;*&#39;</span><span class="pun">)()});</span><span class="kwd">function</span><span class="pln"> </span><span class="typ">InlineLexer</span><span class="pun">(</span><span class="pln">links</span><span class="pun">,</span><span class="pln">options</span><span class="pun">){</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">=</span><span class="pln">options</span><span class="pun">||</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">defaults</span><span class="pun">;</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">links</span><span class="pun">=</span><span class="pln">links</span><span class="pun">;</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">=</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">normal</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(!</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">links</span><span class="pun">){</span><span class="kwd">throw</span><span class="pln"> </span><span class="kwd">new</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="63"></td><td class="FileContents-lineContents" id="63"><span class="typ">Error</span><span class="pun">(</span><span class="str">&#39;Tokens array requires a `links` property.&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="64"></td><td class="FileContents-lineContents" id="64"><span class="kwd">if</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">breaks</span><span class="pun">){</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">=</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">breaks</span><span class="pun">;}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">=</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">gfm</span><span class="pun">;}}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">pedantic</span><span class="pun">){</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">=</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">pedantic</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="65"></td><td class="FileContents-lineContents" id="65"><span class="typ">InlineLexer</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">=</span><span class="kwd">inline</span><span class="pun">;</span><span class="typ">InlineLexer</span><span class="pun">.</span><span class="pln">output</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">src</span><span class="pun">,</span><span class="pln">links</span><span class="pun">,</span><span class="pln">opt</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> </span><span class="kwd">inline</span><span class="pun">=</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">InlineLexer</span><span class="pun">(</span><span class="pln">links</span><span class="pun">,</span><span class="pln">opt</span><span class="pun">);</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="pln">src</span><span class="pun">);};</span><span class="typ">InlineLexer</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">output</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">src</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> out</span><span class="pun">=</span><span class="str">&#39;&#39;</span><span class="pun">,</span><span class="pln">link</span><span class="pun">,</span><span class="pln">text</span><span class="pun">,</span><span class="pln">href</span><span class="pun">,</span><span class="pln">cap</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">src</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">escape</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">out</span><span class="pun">+=</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="66"></td><td class="FileContents-lineContents" id="66"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">autolink</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]===</span><span class="str">&#39;@&#39;</span><span class="pun">){</span><span class="pln">text</span><span class="pun">=</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">6</span><span class="pun">]===</span><span class="str">&#39;:&#39;</span><span class="pun">?</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">mangle</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">7</span><span class="pun">)):</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">mangle</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">href</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">mangle</span><span class="pun">(</span><span class="str">&#39;mailto:&#39;</span><span class="pun">)+</span><span class="pln">text</span><span class="pun">;}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">text</span><span class="pun">=</span><span class="pln">escape</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">href</span><span class="pun">=</span><span class="pln">text</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="67"></td><td class="FileContents-lineContents" id="67"><span class="pln">out</span><span class="pun">+=</span><span class="str">&#39;&lt;a href=&quot;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="68"></td><td class="FileContents-lineContents" id="68"><span class="pun">+</span><span class="pln">href</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="69"></td><td class="FileContents-lineContents" id="69"><span class="pun">+</span><span class="str">&#39;&quot;&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="70"></td><td class="FileContents-lineContents" id="70"><span class="pun">+</span><span class="pln">text</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="71"></td><td class="FileContents-lineContents" id="71"><span class="pun">+</span><span class="str">&#39;&lt;/a&gt;&#39;</span><span class="pun">;</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="72"></td><td class="FileContents-lineContents" id="72"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">url</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">text</span><span class="pun">=</span><span class="pln">escape</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">href</span><span class="pun">=</span><span class="pln">text</span><span class="pun">;</span><span class="pln">out</span><span class="pun">+=</span><span class="str">&#39;&lt;a href=&quot;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="73"></td><td class="FileContents-lineContents" id="73"><span class="pun">+</span><span class="pln">href</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="74"></td><td class="FileContents-lineContents" id="74"><span class="pun">+</span><span class="str">&#39;&quot;&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="75"></td><td class="FileContents-lineContents" id="75"><span class="pun">+</span><span class="pln">text</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="76"></td><td class="FileContents-lineContents" id="76"><span class="pun">+</span><span class="str">&#39;&lt;/a&gt;&#39;</span><span class="pun">;</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="77"></td><td class="FileContents-lineContents" id="77"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">tag</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">out</span><span class="pun">+=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">sanitize</span><span class="pun">?</span><span class="pln">escape</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]):</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="78"></td><td class="FileContents-lineContents" id="78"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">link</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">out</span><span class="pun">+=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">outputLink</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">,{</span><span class="pln">href</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">],</span><span class="pln">title</span><span class="pun">:</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]});</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="79"></td><td class="FileContents-lineContents" id="79"><span class="kwd">if</span><span class="pun">((</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">reflink</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">))||(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">nolink</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">))){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">link</span><span class="pun">=(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]||</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]).</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/\s+/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39; &#39;</span><span class="pun">);</span><span class="pln">link</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">links</span><span class="pun">[</span><span class="pln">link</span><span class="pun">.</span><span class="pln">toLowerCase</span><span class="pun">()];</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">link</span><span class="pun">||!</span><span class="pln">link</span><span class="pun">.</span><span class="pln">href</span><span class="pun">){</span><span class="pln">out</span><span class="pun">+=</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">src</span><span class="pun">=</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)+</span><span class="pln">src</span><span class="pun">;</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="80"></td><td class="FileContents-lineContents" id="80"><span class="pln">out</span><span class="pun">+=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">outputLink</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">,</span><span class="pln">link</span><span class="pun">);</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="81"></td><td class="FileContents-lineContents" id="81"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">strong</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">out</span><span class="pun">+=</span><span class="str">&#39;&lt;strong&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="82"></td><td class="FileContents-lineContents" id="82"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]||</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="83"></td><td class="FileContents-lineContents" id="83"><span class="pun">+</span><span class="str">&#39;&lt;/strong&gt;&#39;</span><span class="pun">;</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="84"></td><td class="FileContents-lineContents" id="84"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">em</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">out</span><span class="pun">+=</span><span class="str">&#39;&lt;em&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="85"></td><td class="FileContents-lineContents" id="85"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]||</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="86"></td><td class="FileContents-lineContents" id="86"><span class="pun">+</span><span class="str">&#39;&lt;/em&gt;&#39;</span><span class="pun">;</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="87"></td><td class="FileContents-lineContents" id="87"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">code</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">out</span><span class="pun">+=</span><span class="str">&#39;&lt;code&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="88"></td><td class="FileContents-lineContents" id="88"><span class="pun">+</span><span class="pln">escape</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">2</span><span class="pun">],</span><span class="kwd">true</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="89"></td><td class="FileContents-lineContents" id="89"><span class="pun">+</span><span class="str">&#39;&lt;/code&gt;&#39;</span><span class="pun">;</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="90"></td><td class="FileContents-lineContents" id="90"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">br</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">out</span><span class="pun">+=</span><span class="str">&#39;&lt;br&gt;&#39;</span><span class="pun">;</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="91"></td><td class="FileContents-lineContents" id="91"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">del</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">out</span><span class="pun">+=</span><span class="str">&#39;&lt;del&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="92"></td><td class="FileContents-lineContents" id="92"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="93"></td><td class="FileContents-lineContents" id="93"><span class="pun">+</span><span class="str">&#39;&lt;/del&gt;&#39;</span><span class="pun">;</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="94"></td><td class="FileContents-lineContents" id="94"><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">rules</span><span class="pun">.</span><span class="pln">text</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">src</span><span class="pun">)){</span><span class="pln">src</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="pln">out</span><span class="pun">+=</span><span class="pln">escape</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span><span class="kwd">continue</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="95"></td><td class="FileContents-lineContents" id="95"><span class="kwd">if</span><span class="pun">(</span><span class="pln">src</span><span class="pun">){</span><span class="kwd">throw</span><span class="pln"> </span><span class="kwd">new</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="96"></td><td class="FileContents-lineContents" id="96"><span class="typ">Error</span><span class="pun">(</span><span class="str">&#39;Infinite loop on byte: &#39;</span><span class="pun">+</span><span class="pln">src</span><span class="pun">.</span><span class="pln">charCodeAt</span><span class="pun">(</span><span class="lit">0</span><span class="pun">));}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="97"></td><td class="FileContents-lineContents" id="97"><span class="kwd">return</span><span class="pln"> out</span><span class="pun">;};</span><span class="typ">InlineLexer</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">outputLink</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">,</span><span class="pln">link</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]!==</span><span class="str">&#39;!&#39;</span><span class="pun">){</span><span class="kwd">return</span><span class="str">&#39;&lt;a href=&quot;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="98"></td><td class="FileContents-lineContents" id="98"><span class="pun">+</span><span class="pln">escape</span><span class="pun">(</span><span class="pln">link</span><span class="pun">.</span><span class="pln">href</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="99"></td><td class="FileContents-lineContents" id="99"><span class="pun">+</span><span class="str">&#39;&quot;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="100"></td><td class="FileContents-lineContents" id="100"><span class="pun">+(</span><span class="pln">link</span><span class="pun">.</span><span class="pln">title</span><span class="pun">?</span><span class="str">&#39; title=&quot;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="101"></td><td class="FileContents-lineContents" id="101"><span class="pun">+</span><span class="pln">escape</span><span class="pun">(</span><span class="pln">link</span><span class="pun">.</span><span class="pln">title</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="102"></td><td class="FileContents-lineContents" id="102"><span class="pun">+</span><span class="str">&#39;&quot;&#39;</span><span class="pun">:</span><span class="str">&#39;&#39;</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="103"></td><td class="FileContents-lineContents" id="103"><span class="pun">+</span><span class="str">&#39;&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="104"></td><td class="FileContents-lineContents" id="104"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="105"></td><td class="FileContents-lineContents" id="105"><span class="pun">+</span><span class="str">&#39;&lt;/a&gt;&#39;</span><span class="pun">;}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">return</span><span class="str">&#39;&lt;img src=&quot;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="106"></td><td class="FileContents-lineContents" id="106"><span class="pun">+</span><span class="pln">escape</span><span class="pun">(</span><span class="pln">link</span><span class="pun">.</span><span class="pln">href</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="107"></td><td class="FileContents-lineContents" id="107"><span class="pun">+</span><span class="str">&#39;&quot; alt=&quot;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="108"></td><td class="FileContents-lineContents" id="108"><span class="pun">+</span><span class="pln">escape</span><span class="pun">(</span><span class="pln">cap</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="109"></td><td class="FileContents-lineContents" id="109"><span class="pun">+</span><span class="str">&#39;&quot;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="110"></td><td class="FileContents-lineContents" id="110"><span class="pun">+(</span><span class="pln">link</span><span class="pun">.</span><span class="pln">title</span><span class="pun">?</span><span class="str">&#39; title=&quot;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="111"></td><td class="FileContents-lineContents" id="111"><span class="pun">+</span><span class="pln">escape</span><span class="pun">(</span><span class="pln">link</span><span class="pun">.</span><span class="pln">title</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="112"></td><td class="FileContents-lineContents" id="112"><span class="pun">+</span><span class="str">&#39;&quot;&#39;</span><span class="pun">:</span><span class="str">&#39;&#39;</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="113"></td><td class="FileContents-lineContents" id="113"><span class="pun">+</span><span class="str">&#39;&gt;&#39;</span><span class="pun">;}};</span><span class="typ">InlineLexer</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">mangle</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">text</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> out</span><span class="pun">=</span><span class="str">&#39;&#39;</span><span class="pun">,</span><span class="pln">l</span><span class="pun">=</span><span class="pln">text</span><span class="pun">.</span><span class="pln">length</span><span class="pun">,</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">ch</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">l</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">ch</span><span class="pun">=</span><span class="pln">text</span><span class="pun">.</span><span class="pln">charCodeAt</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">random</span><span class="pun">()&gt;</span><span class="lit">0.5</span><span class="pun">){</span><span class="pln">ch</span><span class="pun">=</span><span class="str">&#39;x&#39;</span><span class="pun">+</span><span class="pln">ch</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">(</span><span class="lit">16</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="114"></td><td class="FileContents-lineContents" id="114"><span class="pln">out</span><span class="pun">+=</span><span class="str">&#39;&amp;#&#39;</span><span class="pun">+</span><span class="pln">ch</span><span class="pun">+</span><span class="str">&#39;;&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="115"></td><td class="FileContents-lineContents" id="115"><span class="kwd">return</span><span class="pln"> out</span><span class="pun">;};</span><span class="kwd">function</span><span class="pln"> </span><span class="typ">Parser</span><span class="pun">(</span><span class="pln">options</span><span class="pun">){</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">=[];</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">=</span><span class="kwd">null</span><span class="pun">;</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">=</span><span class="pln">options</span><span class="pun">||</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">defaults</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="116"></td><td class="FileContents-lineContents" id="116"><span class="typ">Parser</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">src</span><span class="pun">,</span><span class="pln">options</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> parser</span><span class="pun">=</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Parser</span><span class="pun">(</span><span class="pln">options</span><span class="pun">);</span><span class="kwd">return</span><span class="pln"> parser</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">(</span><span class="pln">src</span><span class="pun">);};</span><span class="typ">Parser</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">src</span><span class="pun">){</span><span class="kwd">this</span><span class="pun">.</span><span class="kwd">inline</span><span class="pun">=</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">InlineLexer</span><span class="pun">(</span><span class="pln">src</span><span class="pun">.</span><span class="pln">links</span><span class="pun">,</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">);</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">=</span><span class="pln">src</span><span class="pun">.</span><span class="pln">reverse</span><span class="pun">();</span><span class="kwd">var</span><span class="pln"> out</span><span class="pun">=</span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">next</span><span class="pun">()){</span><span class="pln">out</span><span class="pun">+=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tok</span><span class="pun">();}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="117"></td><td class="FileContents-lineContents" id="117"><span class="kwd">return</span><span class="pln"> out</span><span class="pun">;};</span><span class="typ">Parser</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">next</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">();};</span><span class="typ">Parser</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">peek</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">[</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">length</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]||</span><span class="lit">0</span><span class="pun">;};</span><span class="typ">Parser</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">parseText</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">var</span><span class="pln"> body</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">peek</span><span class="pun">().</span><span class="pln">type</span><span class="pun">===</span><span class="str">&#39;text&#39;</span><span class="pun">){</span><span class="pln">body</span><span class="pun">+=</span><span class="str">&#39;\n&#39;</span><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">next</span><span class="pun">().</span><span class="pln">text</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="118"></td><td class="FileContents-lineContents" id="118"><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="pln">body</span><span class="pun">);};</span><span class="typ">Parser</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">tok</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">switch</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">type</span><span class="pun">){</span><span class="kwd">case</span><span class="str">&#39;space&#39;</span><span class="pun">:{</span><span class="kwd">return</span><span class="str">&#39;&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="119"></td><td class="FileContents-lineContents" id="119"><span class="kwd">case</span><span class="str">&#39;hr&#39;</span><span class="pun">:{</span><span class="kwd">return</span><span class="str">&#39;&lt;hr&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="120"></td><td class="FileContents-lineContents" id="120"><span class="kwd">case</span><span class="str">&#39;heading&#39;</span><span class="pun">:{</span><span class="kwd">return</span><span class="str">&#39;&lt;h&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="121"></td><td class="FileContents-lineContents" id="121"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">depth</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="122"></td><td class="FileContents-lineContents" id="122"><span class="pun">+</span><span class="str">&#39;&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="123"></td><td class="FileContents-lineContents" id="123"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="124"></td><td class="FileContents-lineContents" id="124"><span class="pun">+</span><span class="str">&#39;&lt;/h&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="125"></td><td class="FileContents-lineContents" id="125"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">depth</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="126"></td><td class="FileContents-lineContents" id="126"><span class="pun">+</span><span class="str">&#39;&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="127"></td><td class="FileContents-lineContents" id="127"><span class="kwd">case</span><span class="str">&#39;code&#39;</span><span class="pun">:{</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">highlight</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> code</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">highlight</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span><span class="pun">,</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">lang</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">code</span><span class="pun">!=</span><span class="kwd">null</span><span class="pun">&amp;&amp;</span><span class="pln">code</span><span class="pun">!==</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span><span class="pun">){</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">escaped</span><span class="pun">=</span><span class="kwd">true</span><span class="pun">;</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span><span class="pun">=</span><span class="pln">code</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="128"></td><td class="FileContents-lineContents" id="128"><span class="kwd">if</span><span class="pun">(!</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">escaped</span><span class="pun">){</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span><span class="pun">=</span><span class="pln">escape</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span><span class="pun">,</span><span class="kwd">true</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="129"></td><td class="FileContents-lineContents" id="129"><span class="kwd">return</span><span class="str">&#39;&lt;pre&gt;&lt;code&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="130"></td><td class="FileContents-lineContents" id="130"><span class="pun">+(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">lang</span><span class="pun">?</span><span class="str">&#39; class=&quot;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="131"></td><td class="FileContents-lineContents" id="131"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">langPrefix</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="132"></td><td class="FileContents-lineContents" id="132"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">lang</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="133"></td><td class="FileContents-lineContents" id="133"><span class="pun">+</span><span class="str">&#39;&quot;&#39;</span><span class="pun">:</span><span class="str">&#39;&#39;</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="134"></td><td class="FileContents-lineContents" id="134"><span class="pun">+</span><span class="str">&#39;&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="135"></td><td class="FileContents-lineContents" id="135"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="136"></td><td class="FileContents-lineContents" id="136"><span class="pun">+</span><span class="str">&#39;&lt;/code&gt;&lt;/pre&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="137"></td><td class="FileContents-lineContents" id="137"><span class="kwd">case</span><span class="str">&#39;table&#39;</span><span class="pun">:{</span><span class="kwd">var</span><span class="pln"> body</span><span class="pun">=</span><span class="str">&#39;&#39;</span><span class="pun">,</span><span class="pln">heading</span><span class="pun">,</span><span class="pln">i</span><span class="pun">,</span><span class="pln">row</span><span class="pun">,</span><span class="pln">cell</span><span class="pun">,</span><span class="pln">j</span><span class="pun">;</span><span class="pln">body</span><span class="pun">+=</span><span class="str">&#39;&lt;thead&gt;\n&lt;tr&gt;\n&#39;</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">header</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">heading</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">header</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">body</span><span class="pun">+=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]?</span><span class="str">&#39;&lt;th align=&quot;&#39;</span><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="str">&#39;&quot;&gt;&#39;</span><span class="pun">+</span><span class="pln">heading</span><span class="pun">+</span><span class="str">&#39;&lt;/th&gt;\n&#39;</span><span class="pun">:</span><span class="str">&#39;&lt;th&gt;&#39;</span><span class="pun">+</span><span class="pln">heading</span><span class="pun">+</span><span class="str">&#39;&lt;/th&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="138"></td><td class="FileContents-lineContents" id="138"><span class="pln">body</span><span class="pun">+=</span><span class="str">&#39;&lt;/tr&gt;\n&lt;/thead&gt;\n&#39;</span><span class="pun">;</span><span class="pln">body</span><span class="pun">+=</span><span class="str">&#39;&lt;tbody&gt;\n&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="139"></td><td class="FileContents-lineContents" id="139"><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">cells</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">row</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">cells</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">body</span><span class="pun">+=</span><span class="str">&#39;&lt;tr&gt;\n&#39;</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">row</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++){</span><span class="pln">cell</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="pln">row</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">body</span><span class="pun">+=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]?</span><span class="str">&#39;&lt;td align=&quot;&#39;</span><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">align</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]+</span><span class="str">&#39;&quot;&gt;&#39;</span><span class="pun">+</span><span class="pln">cell</span><span class="pun">+</span><span class="str">&#39;&lt;/td&gt;\n&#39;</span><span class="pun">:</span><span class="str">&#39;&lt;td&gt;&#39;</span><span class="pun">+</span><span class="pln">cell</span><span class="pun">+</span><span class="str">&#39;&lt;/td&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="140"></td><td class="FileContents-lineContents" id="140"><span class="pln">body</span><span class="pun">+=</span><span class="str">&#39;&lt;/tr&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="141"></td><td class="FileContents-lineContents" id="141"><span class="pln">body</span><span class="pun">+=</span><span class="str">&#39;&lt;/tbody&gt;\n&#39;</span><span class="pun">;</span><span class="kwd">return</span><span class="str">&#39;&lt;table&gt;\n&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="142"></td><td class="FileContents-lineContents" id="142"><span class="pun">+</span><span class="pln">body</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="143"></td><td class="FileContents-lineContents" id="143"><span class="pun">+</span><span class="str">&#39;&lt;/table&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="144"></td><td class="FileContents-lineContents" id="144"><span class="kwd">case</span><span class="str">&#39;blockquote_start&#39;</span><span class="pun">:{</span><span class="kwd">var</span><span class="pln"> body</span><span class="pun">=</span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">next</span><span class="pun">().</span><span class="pln">type</span><span class="pun">!==</span><span class="str">&#39;blockquote_end&#39;</span><span class="pun">){</span><span class="pln">body</span><span class="pun">+=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tok</span><span class="pun">();}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="145"></td><td class="FileContents-lineContents" id="145"><span class="kwd">return</span><span class="str">&#39;&lt;blockquote&gt;\n&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="146"></td><td class="FileContents-lineContents" id="146"><span class="pun">+</span><span class="pln">body</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="147"></td><td class="FileContents-lineContents" id="147"><span class="pun">+</span><span class="str">&#39;&lt;/blockquote&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="148"></td><td class="FileContents-lineContents" id="148"><span class="kwd">case</span><span class="str">&#39;list_start&#39;</span><span class="pun">:{</span><span class="kwd">var</span><span class="pln"> type</span><span class="pun">=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">ordered</span><span class="pun">?</span><span class="str">&#39;ol&#39;</span><span class="pun">:</span><span class="str">&#39;ul&#39;</span><span class="pun">,</span><span class="pln">body</span><span class="pun">=</span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">next</span><span class="pun">().</span><span class="pln">type</span><span class="pun">!==</span><span class="str">&#39;list_end&#39;</span><span class="pun">){</span><span class="pln">body</span><span class="pun">+=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tok</span><span class="pun">();}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="149"></td><td class="FileContents-lineContents" id="149"><span class="kwd">return</span><span class="str">&#39;&lt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="150"></td><td class="FileContents-lineContents" id="150"><span class="pun">+</span><span class="pln">type</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="151"></td><td class="FileContents-lineContents" id="151"><span class="pun">+</span><span class="str">&#39;&gt;\n&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="152"></td><td class="FileContents-lineContents" id="152"><span class="pun">+</span><span class="pln">body</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="153"></td><td class="FileContents-lineContents" id="153"><span class="pun">+</span><span class="str">&#39;&lt;/&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="154"></td><td class="FileContents-lineContents" id="154"><span class="pun">+</span><span class="pln">type</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="155"></td><td class="FileContents-lineContents" id="155"><span class="pun">+</span><span class="str">&#39;&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="156"></td><td class="FileContents-lineContents" id="156"><span class="kwd">case</span><span class="str">&#39;list_item_start&#39;</span><span class="pun">:{</span><span class="kwd">var</span><span class="pln"> body</span><span class="pun">=</span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">next</span><span class="pun">().</span><span class="pln">type</span><span class="pun">!==</span><span class="str">&#39;list_item_end&#39;</span><span class="pun">){</span><span class="pln">body</span><span class="pun">+=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">type</span><span class="pun">===</span><span class="str">&#39;text&#39;</span><span class="pun">?</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">parseText</span><span class="pun">():</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tok</span><span class="pun">();}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="157"></td><td class="FileContents-lineContents" id="157"><span class="kwd">return</span><span class="str">&#39;&lt;li&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="158"></td><td class="FileContents-lineContents" id="158"><span class="pun">+</span><span class="pln">body</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="159"></td><td class="FileContents-lineContents" id="159"><span class="pun">+</span><span class="str">&#39;&lt;/li&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="160"></td><td class="FileContents-lineContents" id="160"><span class="kwd">case</span><span class="str">&#39;loose_item_start&#39;</span><span class="pun">:{</span><span class="kwd">var</span><span class="pln"> body</span><span class="pun">=</span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">next</span><span class="pun">().</span><span class="pln">type</span><span class="pun">!==</span><span class="str">&#39;list_item_end&#39;</span><span class="pun">){</span><span class="pln">body</span><span class="pun">+=</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">tok</span><span class="pun">();}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="161"></td><td class="FileContents-lineContents" id="161"><span class="kwd">return</span><span class="str">&#39;&lt;li&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="162"></td><td class="FileContents-lineContents" id="162"><span class="pun">+</span><span class="pln">body</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="163"></td><td class="FileContents-lineContents" id="163"><span class="pun">+</span><span class="str">&#39;&lt;/li&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="164"></td><td class="FileContents-lineContents" id="164"><span class="kwd">case</span><span class="str">&#39;html&#39;</span><span class="pun">:{</span><span class="kwd">return</span><span class="pun">!</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">pre</span><span class="pun">&amp;&amp;!</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">options</span><span class="pun">.</span><span class="pln">pedantic</span><span class="pun">?</span><span class="kwd">this</span><span class="pun">.</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span><span class="pun">):</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="165"></td><td class="FileContents-lineContents" id="165"><span class="kwd">case</span><span class="str">&#39;paragraph&#39;</span><span class="pun">:{</span><span class="kwd">return</span><span class="str">&#39;&lt;p&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="166"></td><td class="FileContents-lineContents" id="166"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="kwd">inline</span><span class="pun">.</span><span class="pln">output</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">token</span><span class="pun">.</span><span class="pln">text</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="167"></td><td class="FileContents-lineContents" id="167"><span class="pun">+</span><span class="str">&#39;&lt;/p&gt;\n&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="168"></td><td class="FileContents-lineContents" id="168"><span class="kwd">case</span><span class="str">&#39;text&#39;</span><span class="pun">:{</span><span class="kwd">return</span><span class="str">&#39;&lt;p&gt;&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="169"></td><td class="FileContents-lineContents" id="169"><span class="pun">+</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">parseText</span><span class="pun">()</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="170"></td><td class="FileContents-lineContents" id="170"><span class="pun">+</span><span class="str">&#39;&lt;/p&gt;\n&#39;</span><span class="pun">;}}};</span><span class="kwd">function</span><span class="pln"> escape</span><span class="pun">(</span><span class="pln">html</span><span class="pun">,</span><span class="pln">encode</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> html</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(!</span><span class="pln">encode</span><span class="pun">?</span><span class="str">/&amp;(?!#?\w+;)/</span><span class="pln">g</span><span class="pun">:</span><span class="str">/&amp;/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&amp;amp;&#39;</span><span class="pun">).</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/&lt;/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&amp;lt;&#39;</span><span class="pun">).</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/&gt;/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&amp;gt;&#39;</span><span class="pun">).</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/&quot;/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&amp;quot;&#39;</span><span class="pun">).</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/&#39;/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&amp;#39;&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="171"></td><td class="FileContents-lineContents" id="171"><span class="kwd">function</span><span class="pln"> replace</span><span class="pun">(</span><span class="pln">regex</span><span class="pun">,</span><span class="pln">opt</span><span class="pun">){</span><span class="pln">regex</span><span class="pun">=</span><span class="pln">regex</span><span class="pun">.</span><span class="pln">source</span><span class="pun">;</span><span class="pln">opt</span><span class="pun">=</span><span class="pln">opt</span><span class="pun">||</span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> self</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln">val</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">name</span><span class="pun">)</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="pln">regex</span><span class="pun">,</span><span class="pln">opt</span><span class="pun">);</span><span class="pln">val</span><span class="pun">=</span><span class="pln">val</span><span class="pun">.</span><span class="pln">source</span><span class="pun">||</span><span class="pln">val</span><span class="pun">;</span><span class="pln">val</span><span class="pun">=</span><span class="pln">val</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/(^|[^\[])\^/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;$1&#39;</span><span class="pun">);</span><span class="pln">regex</span><span class="pun">=</span><span class="pln">regex</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">name</span><span class="pun">,</span><span class="pln">val</span><span class="pun">);</span><span class="kwd">return</span><span class="pln"> self</span><span class="pun">;};}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="172"></td><td class="FileContents-lineContents" id="172"><span class="kwd">function</span><span class="pln"> noop</span><span class="pun">(){}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="173"></td><td class="FileContents-lineContents" id="173"><span class="pln">noop</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">=</span><span class="pln">noop</span><span class="pun">;</span><span class="kwd">function</span><span class="pln"> merge</span><span class="pun">(</span><span class="pln">obj</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">target</span><span class="pun">,</span><span class="pln">key</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">arguments</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">target</span><span class="pun">=</span><span class="pln">arguments</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">key in target</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="typ">Object</span><span class="pun">.</span><span class="pln">prototype</span><span class="pun">.</span><span class="pln">hasOwnProperty</span><span class="pun">.</span><span class="pln">call</span><span class="pun">(</span><span class="pln">target</span><span class="pun">,</span><span class="pln">key</span><span class="pun">)){</span><span class="pln">obj</span><span class="pun">[</span><span class="pln">key</span><span class="pun">]=</span><span class="pln">target</span><span class="pun">[</span><span class="pln">key</span><span class="pun">];}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="174"></td><td class="FileContents-lineContents" id="174"><span class="kwd">return</span><span class="pln"> obj</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="175"></td><td class="FileContents-lineContents" id="175"><span class="kwd">function</span><span class="pln"> marked</span><span class="pun">(</span><span class="pln">src</span><span class="pun">,</span><span class="pln">opt</span><span class="pun">){</span><span class="kwd">try</span><span class="pun">{</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">opt</span><span class="pun">)</span><span class="pln">opt</span><span class="pun">=</span><span class="pln">merge</span><span class="pun">({},</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">defaults</span><span class="pun">,</span><span class="pln">opt</span><span class="pun">);</span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Parser</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">(</span><span class="typ">Lexer</span><span class="pun">.</span><span class="pln">lex</span><span class="pun">(</span><span class="pln">src</span><span class="pun">,</span><span class="pln">opt</span><span class="pun">),</span><span class="pln">opt</span><span class="pun">);}</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">e</span><span class="pun">){</span><span class="pln">e</span><span class="pun">.</span><span class="pln">message</span><span class="pun">+=</span><span class="str">&#39;\nPlease report this to https://github.com/chjj/marked.&#39;</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">((</span><span class="pln">opt</span><span class="pun">||</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">defaults</span><span class="pun">).</span><span class="pln">silent</span><span class="pun">){</span><span class="kwd">return</span><span class="str">&#39;An error occured:\n&#39;</span><span class="pun">+</span><span class="pln">e</span><span class="pun">.</span><span class="pln">message</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="176"></td><td class="FileContents-lineContents" id="176"><span class="kwd">throw</span><span class="pln"> e</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="177"></td><td class="FileContents-lineContents" id="177"><span class="pln">marked</span><span class="pun">.</span><span class="pln">options</span><span class="pun">=</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">setOptions</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">opt</span><span class="pun">){</span><span class="pln">merge</span><span class="pun">(</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">defaults</span><span class="pun">,</span><span class="pln">opt</span><span class="pun">);</span><span class="kwd">return</span><span class="pln"> marked</span><span class="pun">;};</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">defaults</span><span class="pun">={</span><span class="pln">gfm</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="pln">tables</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="pln">breaks</span><span class="pun">:</span><span class="kwd">false</span><span class="pun">,</span><span class="pln">pedantic</span><span class="pun">:</span><span class="kwd">false</span><span class="pun">,</span><span class="pln">sanitize</span><span class="pun">:</span><span class="kwd">false</span><span class="pun">,</span><span class="pln">smartLists</span><span class="pun">:</span><span class="kwd">false</span><span class="pun">,</span><span class="pln">silent</span><span class="pun">:</span><span class="kwd">false</span><span class="pun">,</span><span class="pln">highlight</span><span class="pun">:</span><span class="kwd">null</span><span class="pun">,</span><span class="pln">langPrefix</span><span class="pun">:</span><span class="str">&#39;lang-&#39;</span><span class="pun">};</span><span class="pln">marked</span><span class="pun">.</span><span class="typ">Parser</span><span class="pun">=</span><span class="typ">Parser</span><span class="pun">;</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">parser</span><span class="pun">=</span><span class="typ">Parser</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">;</span><span class="pln">marked</span><span class="pun">.</span><span class="typ">Lexer</span><span class="pun">=</span><span class="typ">Lexer</span><span class="pun">;</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">lexer</span><span class="pun">=</span><span class="typ">Lexer</span><span class="pun">.</span><span class="pln">lex</span><span class="pun">;</span><span class="pln">marked</span><span class="pun">.</span><span class="typ">InlineLexer</span><span class="pun">=</span><span class="typ">InlineLexer</span><span class="pun">;</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">inlineLexer</span><span class="pun">=</span><span class="typ">InlineLexer</span><span class="pun">.</span><span class="pln">output</span><span class="pun">;</span><span class="pln">marked</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">=</span><span class="pln">marked</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">typeof</span><span class="pln"> exports</span><span class="pun">===</span><span class="str">&#39;object&#39;</span><span class="pun">){</span><span class="pln">module</span><span class="pun">.</span><span class="pln">exports</span><span class="pun">=</span><span class="pln">marked</span><span class="pun">;}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">typeof</span><span class="pln"> define</span><span class="pun">===</span><span class="str">&#39;function&#39;</span><span class="pun">&amp;&amp;</span><span class="pln">define</span><span class="pun">.</span><span class="pln">amd</span><span class="pun">){</span><span class="pln">define</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">return</span><span class="pln"> marked</span><span class="pun">;});}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">marked</span><span class="pun">=</span><span class="pln">marked</span><span class="pun">;}}).</span><span class="pln">call</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">||(</span><span class="kwd">typeof</span><span class="pln"> window</span><span class="pun">!==</span><span class="str">&#39;undefined&#39;</span><span class="pun">?</span><span class="pln">window</span><span class="pun">:</span><span class="pln">global</span><span class="pun">);}());</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="178"></td><td class="FileContents-lineContents" id="178"><span class="com">// Copyright (C) 2006 Google Inc.</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="179"></td><td class="FileContents-lineContents" id="179"><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="180"></td><td class="FileContents-lineContents" id="180"><span class="com">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="181"></td><td class="FileContents-lineContents" id="181"><span class="com">// you may not use this file except in compliance with the License.</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="182"></td><td class="FileContents-lineContents" id="182"><span class="com">// You may obtain a copy of the License at</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="183"></td><td class="FileContents-lineContents" id="183"><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="184"></td><td class="FileContents-lineContents" id="184"><span class="com">//      http://www.apache.org/licenses/LICENSE-2.0</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="185"></td><td class="FileContents-lineContents" id="185"><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="186"></td><td class="FileContents-lineContents" id="186"><span class="com">// Unless required by applicable law or agreed to in writing, software</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="187"></td><td class="FileContents-lineContents" id="187"><span class="com">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="188"></td><td class="FileContents-lineContents" id="188"><span class="com">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="189"></td><td class="FileContents-lineContents" id="189"><span class="com">// See the License for the specific language governing permissions and</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="190"></td><td class="FileContents-lineContents" id="190"><span class="com">// limitations under the License.</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="191"></td><td class="FileContents-lineContents" id="191"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="192"></td><td class="FileContents-lineContents" id="192"><span class="pln">window</span><span class="pun">[</span><span class="str">&#39;PR_SHOULD_USE_CONTINUATION&#39;</span><span class="pun">]=</span><span class="kwd">true</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> prettyPrintOne</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> prettyPrint</span><span class="pun">;(</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">var</span><span class="pln"> win</span><span class="pun">=</span><span class="pln">window</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> FLOW_CONTROL_KEYWORDS</span><span class="pun">=[</span><span class="str">&quot;break,continue,do,else,for,if,return,while&quot;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> C_KEYWORDS</span><span class="pun">=[</span><span class="pln">FLOW_CONTROL_KEYWORDS</span><span class="pun">,</span><span class="str">&quot;auto,case,char,const,default,&quot;</span><span class="pun">+</span><span class="str">&quot;double,enum,extern,float,goto,int,long,register,short,signed,sizeof,&quot;</span><span class="pun">+</span><span class="str">&quot;static,struct,switch,typedef,union,unsigned,void,volatile&quot;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> COMMON_KEYWORDS</span><span class="pun">=[</span><span class="pln">C_KEYWORDS</span><span class="pun">,</span><span class="str">&quot;catch,class,delete,false,import,&quot;</span><span class="pun">+</span><span class="str">&quot;new,operator,private,protected,public,this,throw,true,try,typeof&quot;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> CPP_KEYWORDS</span><span class="pun">=[</span><span class="pln">COMMON_KEYWORDS</span><span class="pun">,</span><span class="str">&quot;alignof,align_union,asm,axiom,bool,&quot;</span><span class="pun">+</span><span class="str">&quot;concept,concept_map,const_cast,constexpr,decltype,&quot;</span><span class="pun">+</span><span class="str">&quot;dynamic_cast,explicit,export,friend,inline,late_check,&quot;</span><span class="pun">+</span><span class="str">&quot;mutable,namespace,nullptr,reinterpret_cast,static_assert,static_cast,&quot;</span><span class="pun">+</span><span class="str">&quot;template,typeid,typename,using,virtual,where&quot;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> JAVA_KEYWORDS</span><span class="pun">=[</span><span class="pln">COMMON_KEYWORDS</span><span class="pun">,</span><span class="str">&quot;abstract,boolean,byte,extends,final,finally,implements,import,&quot;</span><span class="pun">+</span><span class="str">&quot;instanceof,null,native,package,strictfp,super,synchronized,throws,&quot;</span><span class="pun">+</span><span class="str">&quot;transient&quot;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> CSHARP_KEYWORDS</span><span class="pun">=[</span><span class="pln">JAVA_KEYWORDS</span><span class="pun">,</span><span class="str">&quot;as,base,by,checked,decimal,delegate,descending,dynamic,event,&quot;</span><span class="pun">+</span><span class="str">&quot;fixed,foreach,from,group,implicit,in,interface,internal,into,is,let,&quot;</span><span class="pun">+</span><span class="str">&quot;lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,&quot;</span><span class="pun">+</span><span class="str">&quot;sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,&quot;</span><span class="pun">+</span><span class="str">&quot;var,virtual,where&quot;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> COFFEE_KEYWORDS</span><span class="pun">=</span><span class="str">&quot;all,and,by,catch,class,else,extends,false,finally,&quot;</span><span class="pun">+</span><span class="str">&quot;for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,&quot;</span><span class="pun">+</span><span class="str">&quot;throw,true,try,unless,until,when,while,yes&quot;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> JSCRIPT_KEYWORDS</span><span class="pun">=[</span><span class="pln">COMMON_KEYWORDS</span><span class="pun">,</span><span class="str">&quot;debugger,eval,export,function,get,null,set,undefined,var,with,&quot;</span><span class="pun">+</span><span class="str">&quot;Infinity,NaN&quot;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> PERL_KEYWORDS</span><span class="pun">=</span><span class="str">&quot;caller,delete,die,do,dump,elsif,eval,exit,foreach,for,&quot;</span><span class="pun">+</span><span class="str">&quot;goto,if,import,last,local,my,next,no,our,print,package,redo,require,&quot;</span><span class="pun">+</span><span class="str">&quot;sub,undef,unless,until,use,wantarray,while,BEGIN,END&quot;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PYTHON_KEYWORDS</span><span class="pun">=[</span><span class="pln">FLOW_CONTROL_KEYWORDS</span><span class="pun">,</span><span class="str">&quot;and,as,assert,class,def,del,&quot;</span><span class="pun">+</span><span class="str">&quot;elif,except,exec,finally,from,global,import,in,is,lambda,&quot;</span><span class="pun">+</span><span class="str">&quot;nonlocal,not,or,pass,print,raise,try,with,yield,&quot;</span><span class="pun">+</span><span class="str">&quot;False,True,None&quot;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> RUBY_KEYWORDS</span><span class="pun">=[</span><span class="pln">FLOW_CONTROL_KEYWORDS</span><span class="pun">,</span><span class="str">&quot;alias,and,begin,case,class,&quot;</span><span class="pun">+</span><span class="str">&quot;def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,&quot;</span><span class="pun">+</span><span class="str">&quot;rescue,retry,self,super,then,true,undef,unless,until,when,yield,&quot;</span><span class="pun">+</span><span class="str">&quot;BEGIN,END&quot;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> SH_KEYWORDS</span><span class="pun">=[</span><span class="pln">FLOW_CONTROL_KEYWORDS</span><span class="pun">,</span><span class="str">&quot;case,done,elif,esac,eval,fi,&quot;</span><span class="pun">+</span><span class="str">&quot;function,in,local,set,then,until&quot;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> ALL_KEYWORDS</span><span class="pun">=[</span><span class="pln">CPP_KEYWORDS</span><span class="pun">,</span><span class="pln">CSHARP_KEYWORDS</span><span class="pun">,</span><span class="pln">JSCRIPT_KEYWORDS</span><span class="pun">,</span><span class="pln">PERL_KEYWORDS</span><span class="pun">+</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="193"></td><td class="FileContents-lineContents" id="193"><span class="pln">PYTHON_KEYWORDS</span><span class="pun">,</span><span class="pln">RUBY_KEYWORDS</span><span class="pun">,</span><span class="pln">SH_KEYWORDS</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> C_TYPES</span><span class="pun">=</span><span class="str">/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)\b/</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_STRING</span><span class="pun">=</span><span class="str">&#39;str&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_KEYWORD</span><span class="pun">=</span><span class="str">&#39;kwd&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_COMMENT</span><span class="pun">=</span><span class="str">&#39;com&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_TYPE</span><span class="pun">=</span><span class="str">&#39;typ&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_LITERAL</span><span class="pun">=</span><span class="str">&#39;lit&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_PUNCTUATION</span><span class="pun">=</span><span class="str">&#39;pun&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_PLAIN</span><span class="pun">=</span><span class="str">&#39;pln&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_TAG</span><span class="pun">=</span><span class="str">&#39;tag&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_DECLARATION</span><span class="pun">=</span><span class="str">&#39;dec&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_SOURCE</span><span class="pun">=</span><span class="str">&#39;src&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_ATTRIB_NAME</span><span class="pun">=</span><span class="str">&#39;atn&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_ATTRIB_VALUE</span><span class="pun">=</span><span class="str">&#39;atv&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> PR_NOCODE</span><span class="pun">=</span><span class="str">&#39;nocode&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> REGEXP_PRECEDER_PATTERN</span><span class="pun">=</span><span class="str">&#39;(?:^^\\.?|[+-]|[!=]=?=?|\\#|%=?|&amp;&amp;?=?|\\(|\\*=?|[+\\-]=|-&gt;|\\/=?|::?|&lt;&lt;?=?|&gt;&gt;?&gt;?=?|,|;|\\?|@|\\[|~|{|\\^\\^?=?|\\|\\|?=?|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\\s*&#39;</span><span class="pun">;</span><span class="kwd">function</span><span class="pln"> combinePrefixPatterns</span><span class="pun">(</span><span class="pln">regexs</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> capturedGroupIndex</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> needToFoldCase</span><span class="pun">=</span><span class="kwd">false</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> ignoreCase</span><span class="pun">=</span><span class="kwd">false</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">=</span><span class="pln">regexs</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> regex</span><span class="pun">=</span><span class="pln">regexs</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">regex</span><span class="pun">.</span><span class="pln">ignoreCase</span><span class="pun">){</span><span class="pln">ignoreCase</span><span class="pun">=</span><span class="kwd">true</span><span class="pun">;}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="str">/[a-z]/</span><span class="pln">i</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">regex</span><span class="pun">.</span><span class="pln">source</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/\\u[0-9a-f]{4}|\\x[0-9a-f]{2}|\\[^ux]/</span><span class="pln">gi</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">))){</span><span class="pln">needToFoldCase</span><span class="pun">=</span><span class="kwd">true</span><span class="pun">;</span><span class="pln">ignoreCase</span><span class="pun">=</span><span class="kwd">false</span><span class="pun">;</span><span class="kwd">break</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="194"></td><td class="FileContents-lineContents" id="194"><span class="kwd">var</span><span class="pln"> escapeCharToCodeUnit</span><span class="pun">={</span><span class="str">&#39;b&#39;</span><span class="pun">:</span><span class="lit">8</span><span class="pun">,</span><span class="str">&#39;t&#39;</span><span class="pun">:</span><span class="lit">9</span><span class="pun">,</span><span class="str">&#39;n&#39;</span><span class="pun">:</span><span class="lit">0xa</span><span class="pun">,</span><span class="str">&#39;v&#39;</span><span class="pun">:</span><span class="lit">0xb</span><span class="pun">,</span><span class="str">&#39;f&#39;</span><span class="pun">:</span><span class="lit">0xc</span><span class="pun">,</span><span class="str">&#39;r&#39;</span><span class="pun">:</span><span class="lit">0xd</span><span class="pun">};</span><span class="kwd">function</span><span class="pln"> decodeEscape</span><span class="pun">(</span><span class="pln">charsetPart</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> cc0</span><span class="pun">=</span><span class="pln">charsetPart</span><span class="pun">.</span><span class="pln">charCodeAt</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cc0</span><span class="pun">!==</span><span class="lit">92</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> cc0</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="195"></td><td class="FileContents-lineContents" id="195"><span class="kwd">var</span><span class="pln"> c1</span><span class="pun">=</span><span class="pln">charsetPart</span><span class="pun">.</span><span class="pln">charAt</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln">cc0</span><span class="pun">=</span><span class="pln">escapeCharToCodeUnit</span><span class="pun">[</span><span class="pln">c1</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cc0</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> cc0</span><span class="pun">;}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="str">&#39;0&#39;</span><span class="pun">&lt;=</span><span class="pln">c1</span><span class="pun">&amp;&amp;</span><span class="pln">c1</span><span class="pun">&lt;=</span><span class="str">&#39;7&#39;</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> parseInt</span><span class="pun">(</span><span class="pln">charsetPart</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">1</span><span class="pun">),</span><span class="lit">8</span><span class="pun">);}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">c1</span><span class="pun">===</span><span class="str">&#39;u&#39;</span><span class="pun">||</span><span class="pln">c1</span><span class="pun">===</span><span class="str">&#39;x&#39;</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> parseInt</span><span class="pun">(</span><span class="pln">charsetPart</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">2</span><span class="pun">),</span><span class="lit">16</span><span class="pun">);}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">return</span><span class="pln"> charsetPart</span><span class="pun">.</span><span class="pln">charCodeAt</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="196"></td><td class="FileContents-lineContents" id="196"><span class="kwd">function</span><span class="pln"> encodeEscape</span><span class="pun">(</span><span class="pln">charCode</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">charCode</span><span class="pun">&lt;</span><span class="lit">0x20</span><span class="pun">){</span><span class="kwd">return</span><span class="pun">(</span><span class="pln">charCode</span><span class="pun">&lt;</span><span class="lit">0x10</span><span class="pun">?</span><span class="str">&#39;\\x0&#39;</span><span class="pun">:</span><span class="str">&#39;\\x&#39;</span><span class="pun">)+</span><span class="pln">charCode</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">(</span><span class="lit">16</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="197"></td><td class="FileContents-lineContents" id="197"><span class="kwd">var</span><span class="pln"> ch</span><span class="pun">=</span><span class="typ">String</span><span class="pun">.</span><span class="pln">fromCharCode</span><span class="pun">(</span><span class="pln">charCode</span><span class="pun">);</span><span class="kwd">return</span><span class="pun">(</span><span class="pln">ch</span><span class="pun">===</span><span class="str">&#39;\\&#39;</span><span class="pun">||</span><span class="pln">ch</span><span class="pun">===</span><span class="str">&#39;-&#39;</span><span class="pun">||</span><span class="pln">ch</span><span class="pun">===</span><span class="str">&#39;]&#39;</span><span class="pun">||</span><span class="pln">ch</span><span class="pun">===</span><span class="str">&#39;^&#39;</span><span class="pun">)?</span><span class="str">&quot;\\&quot;</span><span class="pun">+</span><span class="pln">ch</span><span class="pun">:</span><span class="pln">ch</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="198"></td><td class="FileContents-lineContents" id="198"><span class="kwd">function</span><span class="pln"> caseFoldCharset</span><span class="pun">(</span><span class="pln">charSet</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> charsetParts</span><span class="pun">=</span><span class="pln">charSet</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln">charSet</span><span class="pun">.</span><span class="pln">length</span><span class="pun">-</span><span class="lit">1</span><span class="pun">).</span><span class="pln">match</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="str">&#39;\\\\u[0-9A-Fa-f]{4}&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="199"></td><td class="FileContents-lineContents" id="199"><span class="pun">+</span><span class="str">&#39;|\\\\x[0-9A-Fa-f]{2}&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="200"></td><td class="FileContents-lineContents" id="200"><span class="pun">+</span><span class="str">&#39;|\\\\[0-3][0-7]{0,2}&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="201"></td><td class="FileContents-lineContents" id="201"><span class="pun">+</span><span class="str">&#39;|\\\\[0-7]{1,2}&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="202"></td><td class="FileContents-lineContents" id="202"><span class="pun">+</span><span class="str">&#39;|\\\\[\\s\\S]&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="203"></td><td class="FileContents-lineContents" id="203"><span class="pun">+</span><span class="str">&#39;|-&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="204"></td><td class="FileContents-lineContents" id="204"><span class="pun">+</span><span class="str">&#39;|[^-\\\\]&#39;</span><span class="pun">,</span><span class="str">&#39;g&#39;</span><span class="pun">));</span><span class="kwd">var</span><span class="pln"> ranges</span><span class="pun">=[];</span><span class="kwd">var</span><span class="pln"> inverse</span><span class="pun">=</span><span class="pln">charsetParts</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]===</span><span class="str">&#39;^&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> out</span><span class="pun">=[</span><span class="str">&#39;[&#39;</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">inverse</span><span class="pun">){</span><span class="pln">out</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="str">&#39;^&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="205"></td><td class="FileContents-lineContents" id="205"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">inverse</span><span class="pun">?</span><span class="lit">1</span><span class="pun">:</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">=</span><span class="pln">charsetParts</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> p</span><span class="pun">=</span><span class="pln">charsetParts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="str">/\\[bdsw]/</span><span class="pln">i</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)){</span><span class="pln">out</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">p</span><span class="pun">);}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">var</span><span class="pln"> start</span><span class="pun">=</span><span class="pln">decodeEscape</span><span class="pun">(</span><span class="pln">p</span><span class="pun">);</span><span class="kwd">var</span><span class="pln"> end</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">2</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">&amp;&amp;</span><span class="str">&#39;-&#39;</span><span class="pun">===</span><span class="pln">charsetParts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]){</span><span class="pln">end</span><span class="pun">=</span><span class="pln">decodeEscape</span><span class="pun">(</span><span class="pln">charsetParts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">2</span><span class="pun">]);</span><span class="pln">i</span><span class="pun">+=</span><span class="lit">2</span><span class="pun">;}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">end</span><span class="pun">=</span><span class="pln">start</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="206"></td><td class="FileContents-lineContents" id="206"><span class="pln">ranges</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">start</span><span class="pun">,</span><span class="pln">end</span><span class="pun">]);</span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">end</span><span class="pun">&lt;</span><span class="lit">65</span><span class="pun">||</span><span class="pln">start</span><span class="pun">&gt;</span><span class="lit">122</span><span class="pun">)){</span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">end</span><span class="pun">&lt;</span><span class="lit">65</span><span class="pun">||</span><span class="pln">start</span><span class="pun">&gt;</span><span class="lit">90</span><span class="pun">)){</span><span class="pln">ranges</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="lit">65</span><span class="pun">,</span><span class="pln">start</span><span class="pun">)|</span><span class="lit">32</span><span class="pun">,</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">end</span><span class="pun">,</span><span class="lit">90</span><span class="pun">)|</span><span class="lit">32</span><span class="pun">]);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="207"></td><td class="FileContents-lineContents" id="207"><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">end</span><span class="pun">&lt;</span><span class="lit">97</span><span class="pun">||</span><span class="pln">start</span><span class="pun">&gt;</span><span class="lit">122</span><span class="pun">)){</span><span class="pln">ranges</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="lit">97</span><span class="pun">,</span><span class="pln">start</span><span class="pun">)&amp;~</span><span class="lit">32</span><span class="pun">,</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">end</span><span class="pun">,</span><span class="lit">122</span><span class="pun">)&amp;~</span><span class="lit">32</span><span class="pun">]);}}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="208"></td><td class="FileContents-lineContents" id="208"><span class="pln">ranges</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">){</span><span class="kwd">return</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]-</span><span class="pln">b</span><span class="pun">[</span><span class="lit">0</span><span class="pun">])||(</span><span class="pln">b</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]-</span><span class="pln">a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);});</span><span class="kwd">var</span><span class="pln"> consolidatedRanges</span><span class="pun">=[];</span><span class="kwd">var</span><span class="pln"> lastRange</span><span class="pun">=[];</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">ranges</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> range</span><span class="pun">=</span><span class="pln">ranges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">range</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]&lt;=</span><span class="pln">lastRange</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">){</span><span class="pln">lastRange</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]=</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">lastRange</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln">range</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">consolidatedRanges</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">lastRange</span><span class="pun">=</span><span class="pln">range</span><span class="pun">);}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="209"></td><td class="FileContents-lineContents" id="209"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">consolidatedRanges</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> range</span><span class="pun">=</span><span class="pln">consolidatedRanges</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">out</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">encodeEscape</span><span class="pun">(</span><span class="pln">range</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]));</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">range</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]&gt;</span><span class="pln">range</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">range</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">&gt;</span><span class="pln">range</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]){</span><span class="pln">out</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="str">&#39;-&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="210"></td><td class="FileContents-lineContents" id="210"><span class="pln">out</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">encodeEscape</span><span class="pun">(</span><span class="pln">range</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]));}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="211"></td><td class="FileContents-lineContents" id="211"><span class="pln">out</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="str">&#39;]&#39;</span><span class="pun">);</span><span class="kwd">return</span><span class="pln"> out</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="str">&#39;&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="212"></td><td class="FileContents-lineContents" id="212"><span class="kwd">function</span><span class="pln"> allowAnywhereFoldCaseAndRenumberGroups</span><span class="pun">(</span><span class="pln">regex</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> parts</span><span class="pun">=</span><span class="pln">regex</span><span class="pun">.</span><span class="pln">source</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="str">&#39;(?:&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="213"></td><td class="FileContents-lineContents" id="213"><span class="pun">+</span><span class="str">&#39;\\[(?:[^\\x5C\\x5D]|\\\\[\\s\\S])*\\]&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="214"></td><td class="FileContents-lineContents" id="214"><span class="pun">+</span><span class="str">&#39;|\\\\u[A-Fa-f0-9]{4}&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="215"></td><td class="FileContents-lineContents" id="215"><span class="pun">+</span><span class="str">&#39;|\\\\x[A-Fa-f0-9]{2}&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="216"></td><td class="FileContents-lineContents" id="216"><span class="pun">+</span><span class="str">&#39;|\\\\[0-9]+&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="217"></td><td class="FileContents-lineContents" id="217"><span class="pun">+</span><span class="str">&#39;|\\\\[^ux0-9]&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="218"></td><td class="FileContents-lineContents" id="218"><span class="pun">+</span><span class="str">&#39;|\\(\\?[:!=]&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="219"></td><td class="FileContents-lineContents" id="219"><span class="pun">+</span><span class="str">&#39;|[\\(\\)\\^]&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="220"></td><td class="FileContents-lineContents" id="220"><span class="pun">+</span><span class="str">&#39;|[^\\x5B\\x5C\\(\\)\\^]+&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="221"></td><td class="FileContents-lineContents" id="221"><span class="pun">+</span><span class="str">&#39;)&#39;</span><span class="pun">,</span><span class="str">&#39;g&#39;</span><span class="pun">));</span><span class="kwd">var</span><span class="pln"> n</span><span class="pun">=</span><span class="pln">parts</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> capturedGroups</span><span class="pun">=[];</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">groupIndex</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> p</span><span class="pun">=</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">===</span><span class="str">&#39;(&#39;</span><span class="pun">){++</span><span class="pln">groupIndex</span><span class="pun">;}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="str">&#39;\\&#39;</span><span class="pun">===</span><span class="pln">p</span><span class="pun">.</span><span class="pln">charAt</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)){</span><span class="kwd">var</span><span class="pln"> decimalValue</span><span class="pun">=+</span><span class="pln">p</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">decimalValue</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">decimalValue</span><span class="pun">&lt;=</span><span class="pln">groupIndex</span><span class="pun">){</span><span class="pln">capturedGroups</span><span class="pun">[</span><span class="pln">decimalValue</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">encodeEscape</span><span class="pun">(</span><span class="pln">decimalValue</span><span class="pun">);}}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="222"></td><td class="FileContents-lineContents" id="222"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">capturedGroups</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(-</span><span class="lit">1</span><span class="pun">===</span><span class="pln">capturedGroups</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]){</span><span class="pln">capturedGroups</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=++</span><span class="pln">capturedGroupIndex</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="223"></td><td class="FileContents-lineContents" id="223"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">groupIndex</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> p</span><span class="pun">=</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">===</span><span class="str">&#39;(&#39;</span><span class="pun">){++</span><span class="pln">groupIndex</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">capturedGroups</span><span class="pun">[</span><span class="pln">groupIndex</span><span class="pun">]){</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">&#39;(?:&#39;</span><span class="pun">;}}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="str">&#39;\\&#39;</span><span class="pun">===</span><span class="pln">p</span><span class="pun">.</span><span class="pln">charAt</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)){</span><span class="kwd">var</span><span class="pln"> decimalValue</span><span class="pun">=+</span><span class="pln">p</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">decimalValue</span><span class="pun">&amp;&amp;</span><span class="pln">decimalValue</span><span class="pun">&lt;=</span><span class="pln">groupIndex</span><span class="pun">){</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">&#39;\\&#39;</span><span class="pun">+</span><span class="pln">capturedGroups</span><span class="pun">[</span><span class="pln">decimalValue</span><span class="pun">];}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="224"></td><td class="FileContents-lineContents" id="224"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="str">&#39;^&#39;</span><span class="pun">===</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&amp;&amp;</span><span class="str">&#39;^&#39;</span><span class="pun">!==</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]){</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">&#39;&#39;</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="225"></td><td class="FileContents-lineContents" id="225"><span class="kwd">if</span><span class="pun">(</span><span class="pln">regex</span><span class="pun">.</span><span class="pln">ignoreCase</span><span class="pun">&amp;&amp;</span><span class="pln">needToFoldCase</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> p</span><span class="pun">=</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> ch0</span><span class="pun">=</span><span class="pln">p</span><span class="pun">.</span><span class="pln">charAt</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">length</span><span class="pun">&gt;=</span><span class="lit">2</span><span class="pun">&amp;&amp;</span><span class="pln">ch0</span><span class="pun">===</span><span class="str">&#39;[&#39;</span><span class="pun">){</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">caseFoldCharset</span><span class="pun">(</span><span class="pln">p</span><span class="pun">);}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ch0</span><span class="pun">!==</span><span class="str">&#39;\\&#39;</span><span class="pun">){</span><span class="pln">parts</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">p</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/[a-zA-Z]/</span><span class="pln">g</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">ch</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> cc</span><span class="pun">=</span><span class="pln">ch</span><span class="pun">.</span><span class="pln">charCodeAt</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="kwd">return</span><span class="str">&#39;[&#39;</span><span class="pun">+</span><span class="typ">String</span><span class="pun">.</span><span class="pln">fromCharCode</span><span class="pun">(</span><span class="pln">cc</span><span class="pun">&amp;~</span><span class="lit">32</span><span class="pun">,</span><span class="pln">cc</span><span class="pun">|</span><span class="lit">32</span><span class="pun">)+</span><span class="str">&#39;]&#39;</span><span class="pun">;});}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="226"></td><td class="FileContents-lineContents" id="226"><span class="kwd">return</span><span class="pln"> parts</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="str">&#39;&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="227"></td><td class="FileContents-lineContents" id="227"><span class="kwd">var</span><span class="pln"> rewritten</span><span class="pun">=[];</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">=</span><span class="pln">regexs</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> regex</span><span class="pun">=</span><span class="pln">regexs</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">regex</span><span class="pun">.</span><span class="pln">global</span><span class="pun">||</span><span class="pln">regex</span><span class="pun">.</span><span class="pln">multiline</span><span class="pun">){</span><span class="kwd">throw</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Error</span><span class="pun">(</span><span class="str">&#39;&#39;</span><span class="pun">+</span><span class="pln">regex</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="228"></td><td class="FileContents-lineContents" id="228"><span class="pln">rewritten</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="str">&#39;(?:&#39;</span><span class="pun">+</span><span class="pln">allowAnywhereFoldCaseAndRenumberGroups</span><span class="pun">(</span><span class="pln">regex</span><span class="pun">)+</span><span class="str">&#39;)&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="229"></td><td class="FileContents-lineContents" id="229"><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="pln">rewritten</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="str">&#39;|&#39;</span><span class="pun">),</span><span class="pln">ignoreCase</span><span class="pun">?</span><span class="str">&#39;gi&#39;</span><span class="pun">:</span><span class="str">&#39;g&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="230"></td><td class="FileContents-lineContents" id="230"><span class="kwd">function</span><span class="pln"> extractSourceSpans</span><span class="pun">(</span><span class="pln">node</span><span class="pun">,</span><span class="pln">isPreformatted</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> nocode</span><span class="pun">=</span><span class="str">/(?:^|\s)nocode(?:\s|$)/</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> chunks</span><span class="pun">=[];</span><span class="kwd">var</span><span class="pln"> length</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> spans</span><span class="pun">=[];</span><span class="kwd">var</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="kwd">function</span><span class="pln"> walk</span><span class="pun">(</span><span class="pln">node</span><span class="pun">){</span><span class="kwd">switch</span><span class="pun">(</span><span class="pln">node</span><span class="pun">.</span><span class="pln">nodeType</span><span class="pun">){</span><span class="kwd">case</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">nocode</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">node</span><span class="pun">.</span><span class="pln">className</span><span class="pun">)){</span><span class="kwd">return</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="231"></td><td class="FileContents-lineContents" id="231"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> child</span><span class="pun">=</span><span class="pln">node</span><span class="pun">.</span><span class="pln">firstChild</span><span class="pun">;</span><span class="pln">child</span><span class="pun">;</span><span class="pln">child</span><span class="pun">=</span><span class="pln">child</span><span class="pun">.</span><span class="pln">nextSibling</span><span class="pun">){</span><span class="pln">walk</span><span class="pun">(</span><span class="pln">child</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="232"></td><td class="FileContents-lineContents" id="232"><span class="kwd">var</span><span class="pln"> nodeName</span><span class="pun">=</span><span class="pln">node</span><span class="pun">.</span><span class="pln">nodeName</span><span class="pun">.</span><span class="pln">toLowerCase</span><span class="pun">();</span><span class="kwd">if</span><span class="pun">(</span><span class="str">&#39;br&#39;</span><span class="pun">===</span><span class="pln">nodeName</span><span class="pun">||</span><span class="str">&#39;li&#39;</span><span class="pun">===</span><span class="pln">nodeName</span><span class="pun">){</span><span class="pln">chunks</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]=</span><span class="str">&#39;\n&#39;</span><span class="pun">;</span><span class="pln">spans</span><span class="pun">[</span><span class="pln">k</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">length</span><span class="pun">++;</span><span class="pln">spans</span><span class="pun">[(</span><span class="pln">k</span><span class="pun">++&lt;&lt;</span><span class="lit">1</span><span class="pun">)|</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">node</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="233"></td><td class="FileContents-lineContents" id="233"><span class="kwd">break</span><span class="pun">;</span><span class="kwd">case</span><span class="pln"> </span><span class="lit">3</span><span class="pun">:</span><span class="kwd">case</span><span class="pln"> </span><span class="lit">4</span><span class="pun">:</span><span class="kwd">var</span><span class="pln"> text</span><span class="pun">=</span><span class="pln">node</span><span class="pun">.</span><span class="pln">nodeValue</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">text</span><span class="pun">.</span><span class="pln">length</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">isPreformatted</span><span class="pun">){</span><span class="pln">text</span><span class="pun">=</span><span class="pln">text</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/[ \t\r\n]+/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39; &#39;</span><span class="pun">);}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">text</span><span class="pun">=</span><span class="pln">text</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/\r\n?/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;\n&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="234"></td><td class="FileContents-lineContents" id="234"><span class="pln">chunks</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]=</span><span class="pln">text</span><span class="pun">;</span><span class="pln">spans</span><span class="pun">[</span><span class="pln">k</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">length</span><span class="pun">;</span><span class="pln">length</span><span class="pun">+=</span><span class="pln">text</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">spans</span><span class="pun">[(</span><span class="pln">k</span><span class="pun">++&lt;&lt;</span><span class="lit">1</span><span class="pun">)|</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">node</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="235"></td><td class="FileContents-lineContents" id="235"><span class="kwd">break</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="236"></td><td class="FileContents-lineContents" id="236"><span class="pln">walk</span><span class="pun">(</span><span class="pln">node</span><span class="pun">);</span><span class="kwd">return</span><span class="pun">{</span><span class="pln">sourceCode</span><span class="pun">:</span><span class="pln">chunks</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="str">&#39;&#39;</span><span class="pun">).</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/\n$/</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">),</span><span class="pln">spans</span><span class="pun">:</span><span class="pln">spans</span><span class="pun">};}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="237"></td><td class="FileContents-lineContents" id="237"><span class="kwd">function</span><span class="pln"> appendDecorations</span><span class="pun">(</span><span class="pln">basePos</span><span class="pun">,</span><span class="pln">sourceCode</span><span class="pun">,</span><span class="pln">langHandler</span><span class="pun">,</span><span class="pln">out</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">sourceCode</span><span class="pun">){</span><span class="kwd">return</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="238"></td><td class="FileContents-lineContents" id="238"><span class="kwd">var</span><span class="pln"> job</span><span class="pun">={</span><span class="pln">sourceCode</span><span class="pun">:</span><span class="pln">sourceCode</span><span class="pun">,</span><span class="pln">basePos</span><span class="pun">:</span><span class="pln">basePos</span><span class="pun">};</span><span class="pln">langHandler</span><span class="pun">(</span><span class="pln">job</span><span class="pun">);</span><span class="pln">out</span><span class="pun">.</span><span class="pln">push</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="pln">out</span><span class="pun">,</span><span class="pln">job</span><span class="pun">.</span><span class="pln">decorations</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="239"></td><td class="FileContents-lineContents" id="239"><span class="kwd">var</span><span class="pln"> notWs</span><span class="pun">=</span><span class="str">/\S/</span><span class="pun">;</span><span class="kwd">function</span><span class="pln"> childContentWrapper</span><span class="pun">(</span><span class="pln">element</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> wrapper</span><span class="pun">=</span><span class="kwd">undefined</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> c</span><span class="pun">=</span><span class="pln">element</span><span class="pun">.</span><span class="pln">firstChild</span><span class="pun">;</span><span class="pln">c</span><span class="pun">;</span><span class="pln">c</span><span class="pun">=</span><span class="pln">c</span><span class="pun">.</span><span class="pln">nextSibling</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> type</span><span class="pun">=</span><span class="pln">c</span><span class="pun">.</span><span class="pln">nodeType</span><span class="pun">;</span><span class="pln">wrapper</span><span class="pun">=(</span><span class="pln">type</span><span class="pun">===</span><span class="lit">1</span><span class="pun">)?(</span><span class="pln">wrapper</span><span class="pun">?</span><span class="pln">element</span><span class="pun">:</span><span class="pln">c</span><span class="pun">):(</span><span class="pln">type</span><span class="pun">===</span><span class="lit">3</span><span class="pun">)?(</span><span class="pln">notWs</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">c</span><span class="pun">.</span><span class="pln">nodeValue</span><span class="pun">)?</span><span class="pln">element</span><span class="pun">:</span><span class="pln">wrapper</span><span class="pun">):</span><span class="pln">wrapper</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="240"></td><td class="FileContents-lineContents" id="240"><span class="kwd">return</span><span class="pln"> wrapper</span><span class="pun">===</span><span class="pln">element</span><span class="pun">?</span><span class="kwd">undefined</span><span class="pun">:</span><span class="pln">wrapper</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="241"></td><td class="FileContents-lineContents" id="241"><span class="kwd">function</span><span class="pln"> createSimpleLexer</span><span class="pun">(</span><span class="pln">shortcutStylePatterns</span><span class="pun">,</span><span class="pln">fallthroughStylePatterns</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> shortcuts</span><span class="pun">={};</span><span class="kwd">var</span><span class="pln"> tokenizer</span><span class="pun">;(</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">var</span><span class="pln"> allPatterns</span><span class="pun">=</span><span class="pln">shortcutStylePatterns</span><span class="pun">.</span><span class="pln">concat</span><span class="pun">(</span><span class="pln">fallthroughStylePatterns</span><span class="pun">);</span><span class="kwd">var</span><span class="pln"> allRegexs</span><span class="pun">=[];</span><span class="kwd">var</span><span class="pln"> regexKeys</span><span class="pun">={};</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">=</span><span class="pln">allPatterns</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> patternParts</span><span class="pun">=</span><span class="pln">allPatterns</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> shortcutChars</span><span class="pun">=</span><span class="pln">patternParts</span><span class="pun">[</span><span class="lit">3</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">shortcutChars</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> c</span><span class="pun">=</span><span class="pln">shortcutChars</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;--</span><span class="pln">c</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;){</span><span class="pln">shortcuts</span><span class="pun">[</span><span class="pln">shortcutChars</span><span class="pun">.</span><span class="pln">charAt</span><span class="pun">(</span><span class="pln">c</span><span class="pun">)]=</span><span class="pln">patternParts</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="242"></td><td class="FileContents-lineContents" id="242"><span class="kwd">var</span><span class="pln"> regex</span><span class="pun">=</span><span class="pln">patternParts</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> k</span><span class="pun">=</span><span class="str">&#39;&#39;</span><span class="pun">+</span><span class="pln">regex</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">regexKeys</span><span class="pun">.</span><span class="pln">hasOwnProperty</span><span class="pun">(</span><span class="pln">k</span><span class="pun">)){</span><span class="pln">allRegexs</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">regex</span><span class="pun">);</span><span class="pln">regexKeys</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]=</span><span class="kwd">null</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="243"></td><td class="FileContents-lineContents" id="243"><span class="pln">allRegexs</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="str">/[\0-\uffff]/</span><span class="pun">);</span><span class="pln">tokenizer</span><span class="pun">=</span><span class="pln">combinePrefixPatterns</span><span class="pun">(</span><span class="pln">allRegexs</span><span class="pun">);})();</span><span class="kwd">var</span><span class="pln"> nPatterns</span><span class="pun">=</span><span class="pln">fallthroughStylePatterns</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> decorate</span><span class="pun">=</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">job</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> sourceCode</span><span class="pun">=</span><span class="pln">job</span><span class="pun">.</span><span class="pln">sourceCode</span><span class="pun">,</span><span class="pln">basePos</span><span class="pun">=</span><span class="pln">job</span><span class="pun">.</span><span class="pln">basePos</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> decorations</span><span class="pun">=[</span><span class="pln">basePos</span><span class="pun">,</span><span class="pln">PR_PLAIN</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> pos</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> tokens</span><span class="pun">=</span><span class="pln">sourceCode</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">tokenizer</span><span class="pun">)||[];</span><span class="kwd">var</span><span class="pln"> styleCache</span><span class="pun">={};</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> ti</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">nTokens</span><span class="pun">=</span><span class="pln">tokens</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">ti</span><span class="pun">&lt;</span><span class="pln">nTokens</span><span class="pun">;++</span><span class="pln">ti</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> token</span><span class="pun">=</span><span class="pln">tokens</span><span class="pun">[</span><span class="pln">ti</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> style</span><span class="pun">=</span><span class="pln">styleCache</span><span class="pun">[</span><span class="pln">token</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> match</span><span class="pun">=</span><span class="kwd">void</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> isEmbedded</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">typeof</span><span class="pln"> style</span><span class="pun">===</span><span class="str">&#39;string&#39;</span><span class="pun">){</span><span class="pln">isEmbedded</span><span class="pun">=</span><span class="kwd">false</span><span class="pun">;}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">var</span><span class="pln"> patternParts</span><span class="pun">=</span><span class="pln">shortcuts</span><span class="pun">[</span><span class="pln">token</span><span class="pun">.</span><span class="pln">charAt</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">patternParts</span><span class="pun">){</span><span class="pln">match</span><span class="pun">=</span><span class="pln">token</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">patternParts</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">style</span><span class="pun">=</span><span class="pln">patternParts</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">nPatterns</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">patternParts</span><span class="pun">=</span><span class="pln">fallthroughStylePatterns</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">match</span><span class="pun">=</span><span class="pln">token</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">patternParts</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">match</span><span class="pun">){</span><span class="pln">style</span><span class="pun">=</span><span class="pln">patternParts</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="kwd">break</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="244"></td><td class="FileContents-lineContents" id="244"><span class="kwd">if</span><span class="pun">(!</span><span class="pln">match</span><span class="pun">){</span><span class="pln">style</span><span class="pun">=</span><span class="pln">PR_PLAIN</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="245"></td><td class="FileContents-lineContents" id="245"><span class="pln">isEmbedded</span><span class="pun">=</span><span class="pln">style</span><span class="pun">.</span><span class="pln">length</span><span class="pun">&gt;=</span><span class="lit">5</span><span class="pun">&amp;&amp;</span><span class="str">&#39;lang-&#39;</span><span class="pun">===</span><span class="pln">style</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">5</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">isEmbedded</span><span class="pun">&amp;&amp;!(</span><span class="pln">match</span><span class="pun">&amp;&amp;</span><span class="kwd">typeof</span><span class="pln"> match</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]===</span><span class="str">&#39;string&#39;</span><span class="pun">)){</span><span class="pln">isEmbedded</span><span class="pun">=</span><span class="kwd">false</span><span class="pun">;</span><span class="pln">style</span><span class="pun">=</span><span class="pln">PR_SOURCE</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="246"></td><td class="FileContents-lineContents" id="246"><span class="kwd">if</span><span class="pun">(!</span><span class="pln">isEmbedded</span><span class="pun">){</span><span class="pln">styleCache</span><span class="pun">[</span><span class="pln">token</span><span class="pun">]=</span><span class="pln">style</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="247"></td><td class="FileContents-lineContents" id="247"><span class="kwd">var</span><span class="pln"> tokenStart</span><span class="pun">=</span><span class="pln">pos</span><span class="pun">;</span><span class="pln">pos</span><span class="pun">+=</span><span class="pln">token</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">isEmbedded</span><span class="pun">){</span><span class="pln">decorations</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">basePos</span><span class="pun">+</span><span class="pln">tokenStart</span><span class="pun">,</span><span class="pln">style</span><span class="pun">);}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">var</span><span class="pln"> embeddedSource</span><span class="pun">=</span><span class="pln">match</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> embeddedSourceStart</span><span class="pun">=</span><span class="pln">token</span><span class="pun">.</span><span class="pln">indexOf</span><span class="pun">(</span><span class="pln">embeddedSource</span><span class="pun">);</span><span class="kwd">var</span><span class="pln"> embeddedSourceEnd</span><span class="pun">=</span><span class="pln">embeddedSourceStart</span><span class="pun">+</span><span class="pln">embeddedSource</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">match</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]){</span><span class="pln">embeddedSourceEnd</span><span class="pun">=</span><span class="pln">token</span><span class="pun">.</span><span class="pln">length</span><span class="pun">-</span><span class="pln">match</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="pln">length</span><span class="pun">;</span><span class="pln">embeddedSourceStart</span><span class="pun">=</span><span class="pln">embeddedSourceEnd</span><span class="pun">-</span><span class="pln">embeddedSource</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="248"></td><td class="FileContents-lineContents" id="248"><span class="kwd">var</span><span class="pln"> lang</span><span class="pun">=</span><span class="pln">style</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">5</span><span class="pun">);</span><span class="pln">appendDecorations</span><span class="pun">(</span><span class="pln">basePos</span><span class="pun">+</span><span class="pln">tokenStart</span><span class="pun">,</span><span class="pln">token</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln">embeddedSourceStart</span><span class="pun">),</span><span class="pln">decorate</span><span class="pun">,</span><span class="pln">decorations</span><span class="pun">);</span><span class="pln">appendDecorations</span><span class="pun">(</span><span class="pln">basePos</span><span class="pun">+</span><span class="pln">tokenStart</span><span class="pun">+</span><span class="pln">embeddedSourceStart</span><span class="pun">,</span><span class="pln">embeddedSource</span><span class="pun">,</span><span class="pln">langHandlerForExtension</span><span class="pun">(</span><span class="pln">lang</span><span class="pun">,</span><span class="pln">embeddedSource</span><span class="pun">),</span><span class="pln">decorations</span><span class="pun">);</span><span class="pln">appendDecorations</span><span class="pun">(</span><span class="pln">basePos</span><span class="pun">+</span><span class="pln">tokenStart</span><span class="pun">+</span><span class="pln">embeddedSourceEnd</span><span class="pun">,</span><span class="pln">token</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">embeddedSourceEnd</span><span class="pun">),</span><span class="pln">decorate</span><span class="pun">,</span><span class="pln">decorations</span><span class="pun">);}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="249"></td><td class="FileContents-lineContents" id="249"><span class="pln">job</span><span class="pun">.</span><span class="pln">decorations</span><span class="pun">=</span><span class="pln">decorations</span><span class="pun">;};</span><span class="kwd">return</span><span class="pln"> decorate</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="250"></td><td class="FileContents-lineContents" id="250"><span class="kwd">function</span><span class="pln"> sourceDecorator</span><span class="pun">(</span><span class="pln">options</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> shortcutStylePatterns</span><span class="pun">=[],</span><span class="pln">fallthroughStylePatterns</span><span class="pun">=[];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">options</span><span class="pun">[</span><span class="str">&#39;tripleQuotedStrings&#39;</span><span class="pun">]){</span><span class="pln">shortcutStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_STRING</span><span class="pun">,</span><span class="str">/^(?:\&#39;\&#39;\&#39;(?:[^\&#39;\\]|\\[\s\S]|\&#39;{1,2}(?=[^\&#39;]))*(?:\&#39;\&#39;\&#39;|$)|\&quot;\&quot;\&quot;(?:[^\&quot;\\]|\\[\s\S]|\&quot;{1,2}(?=[^\&quot;]))*(?:\&quot;\&quot;\&quot;|$)|\&#39;(?:[^\\\&#39;]|\\[\s\S])*(?:\&#39;|$)|\&quot;(?:[^\\\&quot;]|\\[\s\S])*(?:\&quot;|$))/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">,</span><span class="str">&#39;\&#39;&quot;&#39;</span><span class="pun">]);}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">options</span><span class="pun">[</span><span class="str">&#39;multiLineStrings&#39;</span><span class="pun">]){</span><span class="pln">shortcutStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_STRING</span><span class="pun">,</span><span class="str">/^(?:\&#39;(?:[^\\\&#39;]|\\[\s\S])*(?:\&#39;|$)|\&quot;(?:[^\\\&quot;]|\\[\s\S])*(?:\&quot;|$)|\`(?:[^\\\`]|\\[\s\S])*(?:\`|$))/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">,</span><span class="str">&#39;\&#39;&quot;`&#39;</span><span class="pun">]);}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">shortcutStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_STRING</span><span class="pun">,</span><span class="str">/^(?:\&#39;(?:[^\\\&#39;\r\n]|\\.)*(?:\&#39;|$)|\&quot;(?:[^\\\&quot;\r\n]|\\.)*(?:\&quot;|$))/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">,</span><span class="str">&#39;&quot;\&#39;&#39;</span><span class="pun">]);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="251"></td><td class="FileContents-lineContents" id="251"><span class="kwd">if</span><span class="pun">(</span><span class="pln">options</span><span class="pun">[</span><span class="str">&#39;verbatimStrings&#39;</span><span class="pun">]){</span><span class="pln">fallthroughStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_STRING</span><span class="pun">,</span><span class="str">/^@\&quot;(?:[^\&quot;]|\&quot;\&quot;)*(?:\&quot;|$)/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">]);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="252"></td><td class="FileContents-lineContents" id="252"><span class="kwd">var</span><span class="pln"> hc</span><span class="pun">=</span><span class="pln">options</span><span class="pun">[</span><span class="str">&#39;hashComments&#39;</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">hc</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">options</span><span class="pun">[</span><span class="str">&#39;cStyleComments&#39;</span><span class="pun">]){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">hc</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">){</span><span class="pln">shortcutStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_COMMENT</span><span class="pun">,</span><span class="str">/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">,</span><span class="str">&#39;#&#39;</span><span class="pun">]);}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">shortcutStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_COMMENT</span><span class="pun">,</span><span class="str">/^#(?:(?:define|e(?:l|nd)if|else|error|ifn?def|include|line|pragma|undef|warning)\b|[^\r\n]*)/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">,</span><span class="str">&#39;#&#39;</span><span class="pun">]);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="253"></td><td class="FileContents-lineContents" id="253"><span class="pln">fallthroughStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_STRING</span><span class="pun">,</span><span class="str">/^&lt;(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h(?:h|pp|\+\+)?|[a-z]\w*)&gt;/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">]);}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">shortcutStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_COMMENT</span><span class="pun">,</span><span class="str">/^#[^\r\n]*/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">,</span><span class="str">&#39;#&#39;</span><span class="pun">]);}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="254"></td><td class="FileContents-lineContents" id="254"><span class="kwd">if</span><span class="pun">(</span><span class="pln">options</span><span class="pun">[</span><span class="str">&#39;cStyleComments&#39;</span><span class="pun">]){</span><span class="pln">fallthroughStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_COMMENT</span><span class="pun">,</span><span class="str">/^\/\/[^\r\n]*/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">]);</span><span class="pln">fallthroughStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_COMMENT</span><span class="pun">,</span><span class="str">/^\/\*[\s\S]*?(?:\*\/|$)/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">]);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="255"></td><td class="FileContents-lineContents" id="255"><span class="kwd">if</span><span class="pun">(</span><span class="pln">options</span><span class="pun">[</span><span class="str">&#39;regexLiterals&#39;</span><span class="pun">]){</span><span class="kwd">var</span><span class="pln"> REGEX_LITERAL</span><span class="pun">=(</span><span class="str">&#39;/(?=[^/*])&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="256"></td><td class="FileContents-lineContents" id="256"><span class="pun">+</span><span class="str">&#39;(?:[^/\\x5B\\x5C]&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="257"></td><td class="FileContents-lineContents" id="257"><span class="pun">+</span><span class="str">&#39;|\\x5C[\\s\\S]&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="258"></td><td class="FileContents-lineContents" id="258"><span class="pun">+</span><span class="str">&#39;|\\x5B(?:[^\\x5C\\x5D]|\\x5C[\\s\\S])*(?:\\x5D|$))+&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="259"></td><td class="FileContents-lineContents" id="259"><span class="pun">+</span><span class="str">&#39;/&#39;</span><span class="pun">);</span><span class="pln">fallthroughStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="str">&#39;lang-regex&#39;</span><span class="pun">,</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="str">&#39;^&#39;</span><span class="pun">+</span><span class="pln">REGEXP_PRECEDER_PATTERN</span><span class="pun">+</span><span class="str">&#39;(&#39;</span><span class="pun">+</span><span class="pln">REGEX_LITERAL</span><span class="pun">+</span><span class="str">&#39;)&#39;</span><span class="pun">)]);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="260"></td><td class="FileContents-lineContents" id="260"><span class="kwd">var</span><span class="pln"> types</span><span class="pun">=</span><span class="pln">options</span><span class="pun">[</span><span class="str">&#39;types&#39;</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">types</span><span class="pun">){</span><span class="pln">fallthroughStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_TYPE</span><span class="pun">,</span><span class="pln">types</span><span class="pun">]);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="261"></td><td class="FileContents-lineContents" id="261"><span class="kwd">var</span><span class="pln"> keywords</span><span class="pun">=(</span><span class="str">&quot;&quot;</span><span class="pun">+</span><span class="pln">options</span><span class="pun">[</span><span class="str">&#39;keywords&#39;</span><span class="pun">]).</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/^ | $/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;&#39;</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">keywords</span><span class="pun">.</span><span class="pln">length</span><span class="pun">){</span><span class="pln">fallthroughStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_KEYWORD</span><span class="pun">,</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="str">&#39;^(?:&#39;</span><span class="pun">+</span><span class="pln">keywords</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="str">/[\s,]+/</span><span class="pln">g</span><span class="pun">,</span><span class="str">&#39;|&#39;</span><span class="pun">)+</span><span class="str">&#39;)\\b&#39;</span><span class="pun">),</span><span class="kwd">null</span><span class="pun">]);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="262"></td><td class="FileContents-lineContents" id="262"><span class="pln">shortcutStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_PLAIN</span><span class="pun">,</span><span class="str">/^\s+/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">,</span><span class="str">&#39; \r\n\t\xA0&#39;</span><span class="pun">]);</span><span class="kwd">var</span><span class="pln"> punctuation</span><span class="pun">=</span><span class="str">/^.[^\s\w\.$@\&#39;\&quot;\`\/\\]*/</span><span class="pun">;</span><span class="pln">fallthroughStylePatterns</span><span class="pun">.</span><span class="pln">push</span><span class="pun">([</span><span class="pln">PR_LITERAL</span><span class="pun">,</span><span class="str">/^@[a-z_$][a-z_$@0-9]*/</span><span class="pln">i</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">],[</span><span class="pln">PR_TYPE</span><span class="pun">,</span><span class="str">/^(?:[@_]?[A-Z]+[a-z][A-Za-z_$@0-9]*|\w+_t\b)/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">],[</span><span class="pln">PR_PLAIN</span><span class="pun">,</span><span class="str">/^[a-z_$][a-z_$@0-9]*/</span><span class="pln">i</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">],[</span><span class="pln">PR_LITERAL</span><span class="pun">,</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="str">&#39;^(?:&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="263"></td><td class="FileContents-lineContents" id="263"><span class="pun">+</span><span class="str">&#39;0x[a-f0-9]+&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="264"></td><td class="FileContents-lineContents" id="264"><span class="pun">+</span><span class="str">&#39;|(?:\\d(?:_\\d+)*\\d*(?:\\.\\d*)?|\\.\\d\\+)&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="265"></td><td class="FileContents-lineContents" id="265"><span class="pun">+</span><span class="str">&#39;(?:e[+\\-]?\\d+)?&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="266"></td><td class="FileContents-lineContents" id="266"><span class="pun">+</span><span class="str">&#39;)&#39;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="267"></td><td class="FileContents-lineContents" id="267"><span class="pun">+</span><span class="str">&#39;[a-z]*&#39;</span><span class="pun">,</span><span class="str">&#39;i&#39;</span><span class="pun">),</span><span class="kwd">null</span><span class="pun">,</span><span class="str">&#39;0123456789&#39;</span><span class="pun">],[</span><span class="pln">PR_PLAIN</span><span class="pun">,</span><span class="str">/^\\[\s\S]?/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">],[</span><span class="pln">PR_PUNCTUATION</span><span class="pun">,</span><span class="pln">punctuation</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">]);</span><span class="kwd">return</span><span class="pln"> createSimpleLexer</span><span class="pun">(</span><span class="pln">shortcutStylePatterns</span><span class="pun">,</span><span class="pln">fallthroughStylePatterns</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="268"></td><td class="FileContents-lineContents" id="268"><span class="kwd">var</span><span class="pln"> decorateSource</span><span class="pun">=</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="pln">ALL_KEYWORDS</span><span class="pun">,</span><span class="str">&#39;hashComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;cStyleComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;multiLineStrings&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;regexLiterals&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">});</span><span class="kwd">function</span><span class="pln"> numberLines</span><span class="pun">(</span><span class="pln">node</span><span class="pun">,</span><span class="pln">opt_startLineNum</span><span class="pun">,</span><span class="pln">isPreformatted</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> nocode</span><span class="pun">=</span><span class="str">/(?:^|\s)nocode(?:\s|$)/</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> lineBreak</span><span class="pun">=</span><span class="str">/\r\n?|\n/</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> document</span><span class="pun">=</span><span class="pln">node</span><span class="pun">.</span><span class="pln">ownerDocument</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> li</span><span class="pun">=</span><span class="pln">document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">&#39;li&#39;</span><span class="pun">);</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">node</span><span class="pun">.</span><span class="pln">firstChild</span><span class="pun">){</span><span class="pln">li</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">node</span><span class="pun">.</span><span class="pln">firstChild</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="269"></td><td class="FileContents-lineContents" id="269"><span class="kwd">var</span><span class="pln"> listItems</span><span class="pun">=[</span><span class="pln">li</span><span class="pun">];</span><span class="kwd">function</span><span class="pln"> walk</span><span class="pun">(</span><span class="pln">node</span><span class="pun">){</span><span class="kwd">switch</span><span class="pun">(</span><span class="pln">node</span><span class="pun">.</span><span class="pln">nodeType</span><span class="pun">){</span><span class="kwd">case</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">nocode</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">node</span><span class="pun">.</span><span class="pln">className</span><span class="pun">)){</span><span class="kwd">break</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="270"></td><td class="FileContents-lineContents" id="270"><span class="kwd">if</span><span class="pun">(</span><span class="str">&#39;br&#39;</span><span class="pun">===</span><span class="pln">node</span><span class="pun">.</span><span class="pln">nodeName</span><span class="pun">){</span><span class="pln">breakAfter</span><span class="pun">(</span><span class="pln">node</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">node</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">){</span><span class="pln">node</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">.</span><span class="pln">removeChild</span><span class="pun">(</span><span class="pln">node</span><span class="pun">);}}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> child</span><span class="pun">=</span><span class="pln">node</span><span class="pun">.</span><span class="pln">firstChild</span><span class="pun">;</span><span class="pln">child</span><span class="pun">;</span><span class="pln">child</span><span class="pun">=</span><span class="pln">child</span><span class="pun">.</span><span class="pln">nextSibling</span><span class="pun">){</span><span class="pln">walk</span><span class="pun">(</span><span class="pln">child</span><span class="pun">);}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="271"></td><td class="FileContents-lineContents" id="271"><span class="kwd">break</span><span class="pun">;</span><span class="kwd">case</span><span class="pln"> </span><span class="lit">3</span><span class="pun">:</span><span class="kwd">case</span><span class="pln"> </span><span class="lit">4</span><span class="pun">:</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">isPreformatted</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> text</span><span class="pun">=</span><span class="pln">node</span><span class="pun">.</span><span class="pln">nodeValue</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> match</span><span class="pun">=</span><span class="pln">text</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">lineBreak</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">match</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> firstLine</span><span class="pun">=</span><span class="pln">text</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln">match</span><span class="pun">.</span><span class="pln">index</span><span class="pun">);</span><span class="pln">node</span><span class="pun">.</span><span class="pln">nodeValue</span><span class="pun">=</span><span class="pln">firstLine</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> tail</span><span class="pun">=</span><span class="pln">text</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">match</span><span class="pun">.</span><span class="pln">index</span><span class="pun">+</span><span class="pln">match</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">length</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">tail</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> parent</span><span class="pun">=</span><span class="pln">node</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">;</span><span class="pln">parent</span><span class="pun">.</span><span class="pln">insertBefore</span><span class="pun">(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">createTextNode</span><span class="pun">(</span><span class="pln">tail</span><span class="pun">),</span><span class="pln">node</span><span class="pun">.</span><span class="pln">nextSibling</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="272"></td><td class="FileContents-lineContents" id="272"><span class="pln">breakAfter</span><span class="pun">(</span><span class="pln">node</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">firstLine</span><span class="pun">){</span><span class="pln">node</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">.</span><span class="pln">removeChild</span><span class="pun">(</span><span class="pln">node</span><span class="pun">);}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="273"></td><td class="FileContents-lineContents" id="273"><span class="kwd">break</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="274"></td><td class="FileContents-lineContents" id="274"><span class="kwd">function</span><span class="pln"> breakAfter</span><span class="pun">(</span><span class="pln">lineEndNode</span><span class="pun">){</span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">lineEndNode</span><span class="pun">.</span><span class="pln">nextSibling</span><span class="pun">){</span><span class="pln">lineEndNode</span><span class="pun">=</span><span class="pln">lineEndNode</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">lineEndNode</span><span class="pun">){</span><span class="kwd">return</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="275"></td><td class="FileContents-lineContents" id="275"><span class="kwd">function</span><span class="pln"> breakLeftOf</span><span class="pun">(</span><span class="pln">limit</span><span class="pun">,</span><span class="pln">copy</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> rightSide</span><span class="pun">=</span><span class="pln">copy</span><span class="pun">?</span><span class="pln">limit</span><span class="pun">.</span><span class="pln">cloneNode</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">):</span><span class="pln">limit</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> parent</span><span class="pun">=</span><span class="pln">limit</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> parentClone</span><span class="pun">=</span><span class="pln">breakLeftOf</span><span class="pun">(</span><span class="pln">parent</span><span class="pun">,</span><span class="lit">1</span><span class="pun">);</span><span class="kwd">var</span><span class="pln"> next</span><span class="pun">=</span><span class="pln">limit</span><span class="pun">.</span><span class="pln">nextSibling</span><span class="pun">;</span><span class="pln">parentClone</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">rightSide</span><span class="pun">);</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> sibling</span><span class="pun">=</span><span class="pln">next</span><span class="pun">;</span><span class="pln">sibling</span><span class="pun">;</span><span class="pln">sibling</span><span class="pun">=</span><span class="pln">next</span><span class="pun">){</span><span class="pln">next</span><span class="pun">=</span><span class="pln">sibling</span><span class="pun">.</span><span class="pln">nextSibling</span><span class="pun">;</span><span class="pln">parentClone</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">sibling</span><span class="pun">);}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="276"></td><td class="FileContents-lineContents" id="276"><span class="kwd">return</span><span class="pln"> rightSide</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="277"></td><td class="FileContents-lineContents" id="277"><span class="kwd">var</span><span class="pln"> copiedListItem</span><span class="pun">=</span><span class="pln">breakLeftOf</span><span class="pun">(</span><span class="pln">lineEndNode</span><span class="pun">.</span><span class="pln">nextSibling</span><span class="pun">,</span><span class="lit">0</span><span class="pun">);</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> parent</span><span class="pun">;(</span><span class="pln">parent</span><span class="pun">=</span><span class="pln">copiedListItem</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">)&amp;&amp;</span><span class="pln">parent</span><span class="pun">.</span><span class="pln">nodeType</span><span class="pun">===</span><span class="lit">1</span><span class="pun">;){</span><span class="pln">copiedListItem</span><span class="pun">=</span><span class="pln">parent</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="278"></td><td class="FileContents-lineContents" id="278"><span class="pln">listItems</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">copiedListItem</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="279"></td><td class="FileContents-lineContents" id="279"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">listItems</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">walk</span><span class="pun">(</span><span class="pln">listItems</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="280"></td><td class="FileContents-lineContents" id="280"><span class="kwd">if</span><span class="pun">(</span><span class="pln">opt_startLineNum</span><span class="pun">===(</span><span class="pln">opt_startLineNum</span><span class="pun">|</span><span class="lit">0</span><span class="pun">)){</span><span class="pln">listItems</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">setAttribute</span><span class="pun">(</span><span class="str">&#39;value&#39;</span><span class="pun">,</span><span class="pln">opt_startLineNum</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="281"></td><td class="FileContents-lineContents" id="281"><span class="kwd">var</span><span class="pln"> ol</span><span class="pun">=</span><span class="pln">document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">&#39;ol&#39;</span><span class="pun">);</span><span class="pln">ol</span><span class="pun">.</span><span class="pln">className</span><span class="pun">=</span><span class="str">&#39;linenums&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> offset</span><span class="pun">=</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,((</span><span class="pln">opt_startLineNum</span><span class="pun">-</span><span class="lit">1</span><span class="pun">))|</span><span class="lit">0</span><span class="pun">)||</span><span class="lit">0</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">=</span><span class="pln">listItems</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">li</span><span class="pun">=</span><span class="pln">listItems</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">li</span><span class="pun">.</span><span class="pln">className</span><span class="pun">=</span><span class="str">&#39;L&#39;</span><span class="pun">+((</span><span class="pln">i</span><span class="pun">+</span><span class="pln">offset</span><span class="pun">)%</span><span class="lit">10</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">li</span><span class="pun">.</span><span class="pln">firstChild</span><span class="pun">){</span><span class="pln">li</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">createTextNode</span><span class="pun">(</span><span class="str">&#39;\xA0&#39;</span><span class="pun">));}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="282"></td><td class="FileContents-lineContents" id="282"><span class="pln">ol</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">li</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="283"></td><td class="FileContents-lineContents" id="283"><span class="pln">node</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">ol</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="284"></td><td class="FileContents-lineContents" id="284"><span class="kwd">function</span><span class="pln"> recombineTagsAndDecorations</span><span class="pun">(</span><span class="pln">job</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> isIE8OrEarlier</span><span class="pun">=</span><span class="str">/\bMSIE\s(\d+)/</span><span class="pun">.</span><span class="pln">exec</span><span class="pun">(</span><span class="pln">navigator</span><span class="pun">.</span><span class="pln">userAgent</span><span class="pun">);</span><span class="pln">isIE8OrEarlier</span><span class="pun">=</span><span class="pln">isIE8OrEarlier</span><span class="pun">&amp;&amp;+</span><span class="pln">isIE8OrEarlier</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]&lt;=</span><span class="lit">8</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> newlineRe</span><span class="pun">=</span><span class="str">/\n/</span><span class="pln">g</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> source</span><span class="pun">=</span><span class="pln">job</span><span class="pun">.</span><span class="pln">sourceCode</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> sourceLength</span><span class="pun">=</span><span class="pln">source</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> sourceIndex</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> spans</span><span class="pun">=</span><span class="pln">job</span><span class="pun">.</span><span class="pln">spans</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> nSpans</span><span class="pun">=</span><span class="pln">spans</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> spanIndex</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> decorations</span><span class="pun">=</span><span class="pln">job</span><span class="pun">.</span><span class="pln">decorations</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> nDecorations</span><span class="pun">=</span><span class="pln">decorations</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> decorationIndex</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">nDecorations</span><span class="pun">]=</span><span class="pln">sourceLength</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> decPos</span><span class="pun">,</span><span class="pln">i</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="pln">decPos</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">nDecorations</span><span class="pun">;){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]!==</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">2</span><span class="pun">]){</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">decPos</span><span class="pun">++]=</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">i</span><span class="pun">++];</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">decPos</span><span class="pun">++]=</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">i</span><span class="pun">++];}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">i</span><span class="pun">+=</span><span class="lit">2</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="285"></td><td class="FileContents-lineContents" id="285"><span class="pln">nDecorations</span><span class="pun">=</span><span class="pln">decPos</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="pln">decPos</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">nDecorations</span><span class="pun">;){</span><span class="kwd">var</span><span class="pln"> startPos</span><span class="pun">=</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> startDec</span><span class="pun">=</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> end</span><span class="pun">=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">2</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">end</span><span class="pun">+</span><span class="lit">2</span><span class="pun">&lt;=</span><span class="pln">nDecorations</span><span class="pun">&amp;&amp;</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">end</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]===</span><span class="pln">startDec</span><span class="pun">){</span><span class="pln">end</span><span class="pun">+=</span><span class="lit">2</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="286"></td><td class="FileContents-lineContents" id="286"><span class="pln">decorations</span><span class="pun">[</span><span class="pln">decPos</span><span class="pun">++]=</span><span class="pln">startPos</span><span class="pun">;</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">decPos</span><span class="pun">++]=</span><span class="pln">startDec</span><span class="pun">;</span><span class="pln">i</span><span class="pun">=</span><span class="pln">end</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="287"></td><td class="FileContents-lineContents" id="287"><span class="pln">nDecorations</span><span class="pun">=</span><span class="pln">decorations</span><span class="pun">.</span><span class="pln">length</span><span class="pun">=</span><span class="pln">decPos</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> sourceNode</span><span class="pun">=</span><span class="pln">job</span><span class="pun">.</span><span class="pln">sourceNode</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> oldDisplay</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sourceNode</span><span class="pun">){</span><span class="pln">oldDisplay</span><span class="pun">=</span><span class="pln">sourceNode</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">display</span><span class="pun">;</span><span class="pln">sourceNode</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">display</span><span class="pun">=</span><span class="str">&#39;none&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="288"></td><td class="FileContents-lineContents" id="288"><span class="kwd">try</span><span class="pun">{</span><span class="kwd">var</span><span class="pln"> decoration</span><span class="pun">=</span><span class="kwd">null</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">spanIndex</span><span class="pun">&lt;</span><span class="pln">nSpans</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> spanStart</span><span class="pun">=</span><span class="pln">spans</span><span class="pun">[</span><span class="pln">spanIndex</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> spanEnd</span><span class="pun">=</span><span class="pln">spans</span><span class="pun">[</span><span class="pln">spanIndex</span><span class="pun">+</span><span class="lit">2</span><span class="pun">]||</span><span class="pln">sourceLength</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> decEnd</span><span class="pun">=</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">decorationIndex</span><span class="pun">+</span><span class="lit">2</span><span class="pun">]||</span><span class="pln">sourceLength</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> end</span><span class="pun">=</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">spanEnd</span><span class="pun">,</span><span class="pln">decEnd</span><span class="pun">);</span><span class="kwd">var</span><span class="pln"> textNode</span><span class="pun">=</span><span class="pln">spans</span><span class="pun">[</span><span class="pln">spanIndex</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> styledText</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">textNode</span><span class="pun">.</span><span class="pln">nodeType</span><span class="pun">!==</span><span class="lit">1</span><span class="pun">&amp;&amp;(</span><span class="pln">styledText</span><span class="pun">=</span><span class="pln">source</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">sourceIndex</span><span class="pun">,</span><span class="pln">end</span><span class="pun">))){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">isIE8OrEarlier</span><span class="pun">){</span><span class="pln">styledText</span><span class="pun">=</span><span class="pln">styledText</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">newlineRe</span><span class="pun">,</span><span class="str">&#39;\r&#39;</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="289"></td><td class="FileContents-lineContents" id="289"><span class="pln">textNode</span><span class="pun">.</span><span class="pln">nodeValue</span><span class="pun">=</span><span class="pln">styledText</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> document</span><span class="pun">=</span><span class="pln">textNode</span><span class="pun">.</span><span class="pln">ownerDocument</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> span</span><span class="pun">=</span><span class="pln">document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">&#39;span&#39;</span><span class="pun">);</span><span class="pln">span</span><span class="pun">.</span><span class="pln">className</span><span class="pun">=</span><span class="pln">decorations</span><span class="pun">[</span><span class="pln">decorationIndex</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> parentNode</span><span class="pun">=</span><span class="pln">textNode</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">;</span><span class="pln">parentNode</span><span class="pun">.</span><span class="pln">replaceChild</span><span class="pun">(</span><span class="pln">span</span><span class="pun">,</span><span class="pln">textNode</span><span class="pun">);</span><span class="pln">span</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">textNode</span><span class="pun">);</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sourceIndex</span><span class="pun">&lt;</span><span class="pln">spanEnd</span><span class="pun">){</span><span class="pln">spans</span><span class="pun">[</span><span class="pln">spanIndex</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">textNode</span><span class="pun">=</span><span class="pln">document</span><span class="pun">.</span><span class="pln">createTextNode</span><span class="pun">(</span><span class="pln">source</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">end</span><span class="pun">,</span><span class="pln">spanEnd</span><span class="pun">));</span><span class="pln">parentNode</span><span class="pun">.</span><span class="pln">insertBefore</span><span class="pun">(</span><span class="pln">textNode</span><span class="pun">,</span><span class="pln">span</span><span class="pun">.</span><span class="pln">nextSibling</span><span class="pun">);}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="290"></td><td class="FileContents-lineContents" id="290"><span class="pln">sourceIndex</span><span class="pun">=</span><span class="pln">end</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sourceIndex</span><span class="pun">&gt;=</span><span class="pln">spanEnd</span><span class="pun">){</span><span class="pln">spanIndex</span><span class="pun">+=</span><span class="lit">2</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="291"></td><td class="FileContents-lineContents" id="291"><span class="kwd">if</span><span class="pun">(</span><span class="pln">sourceIndex</span><span class="pun">&gt;=</span><span class="pln">decEnd</span><span class="pun">){</span><span class="pln">decorationIndex</span><span class="pun">+=</span><span class="lit">2</span><span class="pun">;}}}</span><span class="pln">finally</span><span class="pun">{</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sourceNode</span><span class="pun">){</span><span class="pln">sourceNode</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">display</span><span class="pun">=</span><span class="pln">oldDisplay</span><span class="pun">;}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="292"></td><td class="FileContents-lineContents" id="292"><span class="kwd">var</span><span class="pln"> langHandlerRegistry</span><span class="pun">={};</span><span class="kwd">function</span><span class="pln"> registerLangHandler</span><span class="pun">(</span><span class="pln">handler</span><span class="pun">,</span><span class="pln">fileExtensions</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">fileExtensions</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;){</span><span class="kwd">var</span><span class="pln"> ext</span><span class="pun">=</span><span class="pln">fileExtensions</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">langHandlerRegistry</span><span class="pun">.</span><span class="pln">hasOwnProperty</span><span class="pun">(</span><span class="pln">ext</span><span class="pun">)){</span><span class="pln">langHandlerRegistry</span><span class="pun">[</span><span class="pln">ext</span><span class="pun">]=</span><span class="pln">handler</span><span class="pun">;}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">win</span><span class="pun">[</span><span class="str">&#39;console&#39;</span><span class="pun">]){</span><span class="pln">console</span><span class="pun">[</span><span class="str">&#39;warn&#39;</span><span class="pun">](</span><span class="str">&#39;cannot override language handler %s&#39;</span><span class="pun">,</span><span class="pln">ext</span><span class="pun">);}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="293"></td><td class="FileContents-lineContents" id="293"><span class="kwd">function</span><span class="pln"> langHandlerForExtension</span><span class="pun">(</span><span class="pln">extension</span><span class="pun">,</span><span class="pln">source</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">extension</span><span class="pun">&amp;&amp;</span><span class="pln">langHandlerRegistry</span><span class="pun">.</span><span class="pln">hasOwnProperty</span><span class="pun">(</span><span class="pln">extension</span><span class="pun">))){</span><span class="pln">extension</span><span class="pun">=</span><span class="str">/^\s*&lt;/</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">source</span><span class="pun">)?</span><span class="str">&#39;default-markup&#39;</span><span class="pun">:</span><span class="str">&#39;default-code&#39;</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="294"></td><td class="FileContents-lineContents" id="294"><span class="kwd">return</span><span class="pln"> langHandlerRegistry</span><span class="pun">[</span><span class="pln">extension</span><span class="pun">];}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="295"></td><td class="FileContents-lineContents" id="295"><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">decorateSource</span><span class="pun">,[</span><span class="str">&#39;default-code&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">createSimpleLexer</span><span class="pun">([],[[</span><span class="pln">PR_PLAIN</span><span class="pun">,</span><span class="str">/^[^&lt;?]+/</span><span class="pun">],[</span><span class="pln">PR_DECLARATION</span><span class="pun">,</span><span class="str">/^&lt;!\w[^&gt;]*(?:&gt;|$)/</span><span class="pun">],[</span><span class="pln">PR_COMMENT</span><span class="pun">,</span><span class="str">/^&lt;\!--[\s\S]*?(?:-\-&gt;|$)/</span><span class="pun">],[</span><span class="str">&#39;lang-&#39;</span><span class="pun">,</span><span class="str">/^&lt;\?([\s\S]+?)(?:\?&gt;|$)/</span><span class="pun">],[</span><span class="str">&#39;lang-&#39;</span><span class="pun">,</span><span class="str">/^&lt;%([\s\S]+?)(?:%&gt;|$)/</span><span class="pun">],[</span><span class="pln">PR_PUNCTUATION</span><span class="pun">,</span><span class="str">/^(?:&lt;[%?]|[%?]&gt;)/</span><span class="pun">],[</span><span class="str">&#39;lang-&#39;</span><span class="pun">,</span><span class="str">/^&lt;xmp\b[^&gt;]*&gt;([\s\S]+?)&lt;\/xmp\b[^&gt;]*&gt;/</span><span class="pln">i</span><span class="pun">],[</span><span class="str">&#39;lang-js&#39;</span><span class="pun">,</span><span class="str">/^&lt;script\b[^&gt;]*&gt;([\s\S]*?)(&lt;\/script\b[^&gt;]*&gt;)/</span><span class="pln">i</span><span class="pun">],[</span><span class="str">&#39;lang-css&#39;</span><span class="pun">,</span><span class="str">/^&lt;style\b[^&gt;]*&gt;([\s\S]*?)(&lt;\/style\b[^&gt;]*&gt;)/</span><span class="pln">i</span><span class="pun">],[</span><span class="str">&#39;lang-in.tag&#39;</span><span class="pun">,</span><span class="str">/^(&lt;\/?[a-z][^&lt;&gt;]*&gt;)/</span><span class="pln">i</span><span class="pun">]]),[</span><span class="str">&#39;default-markup&#39;</span><span class="pun">,</span><span class="str">&#39;htm&#39;</span><span class="pun">,</span><span class="str">&#39;html&#39;</span><span class="pun">,</span><span class="str">&#39;mxml&#39;</span><span class="pun">,</span><span class="str">&#39;xhtml&#39;</span><span class="pun">,</span><span class="str">&#39;xml&#39;</span><span class="pun">,</span><span class="str">&#39;xsl&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">createSimpleLexer</span><span class="pun">([[</span><span class="pln">PR_PLAIN</span><span class="pun">,</span><span class="str">/^[\s]+/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">,</span><span class="str">&#39; \t\r\n&#39;</span><span class="pun">],[</span><span class="pln">PR_ATTRIB_VALUE</span><span class="pun">,</span><span class="str">/^(?:\&quot;[^\&quot;]*\&quot;?|\&#39;[^\&#39;]*\&#39;?)/</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">,</span><span class="str">&#39;\&quot;\&#39;&#39;</span><span class="pun">]],[[</span><span class="pln">PR_TAG</span><span class="pun">,</span><span class="str">/^^&lt;\/?[a-z](?:[\w.:-]*\w)?|\/?&gt;$/</span><span class="pln">i</span><span class="pun">],[</span><span class="pln">PR_ATTRIB_NAME</span><span class="pun">,</span><span class="str">/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/</span><span class="pln">i</span><span class="pun">],[</span><span class="str">&#39;lang-uq.val&#39;</span><span class="pun">,</span><span class="str">/^=\s*([^&gt;\&#39;\&quot;\s]*(?:[^&gt;\&#39;\&quot;\s\/]|\/(?=\s)))/</span><span class="pun">],[</span><span class="pln">PR_PUNCTUATION</span><span class="pun">,</span><span class="str">/^[=&lt;&gt;\/]+/</span><span class="pun">],[</span><span class="str">&#39;lang-js&#39;</span><span class="pun">,</span><span class="str">/^on\w+\s*=\s*\&quot;([^\&quot;]+)\&quot;/</span><span class="pln">i</span><span class="pun">],[</span><span class="str">&#39;lang-js&#39;</span><span class="pun">,</span><span class="str">/^on\w+\s*=\s*\&#39;([^\&#39;]+)\&#39;/</span><span class="pln">i</span><span class="pun">],[</span><span class="str">&#39;lang-js&#39;</span><span class="pun">,</span><span class="str">/^on\w+\s*=\s*([^\&quot;\&#39;&gt;\s]+)/</span><span class="pln">i</span><span class="pun">],[</span><span class="str">&#39;lang-css&#39;</span><span class="pun">,</span><span class="str">/^style\s*=\s*\&quot;([^\&quot;]+)\&quot;/</span><span class="pln">i</span><span class="pun">],[</span><span class="str">&#39;lang-css&#39;</span><span class="pun">,</span><span class="str">/^style\s*=\s*\&#39;([^\&#39;]+)\&#39;/</span><span class="pln">i</span><span class="pun">],[</span><span class="str">&#39;lang-css&#39;</span><span class="pun">,</span><span class="str">/^style\s*=\s*([^\&quot;\&#39;&gt;\s]+)/</span><span class="pln">i</span><span class="pun">]]),[</span><span class="str">&#39;in.tag&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">createSimpleLexer</span><span class="pun">([],[[</span><span class="pln">PR_ATTRIB_VALUE</span><span class="pun">,</span><span class="str">/^[\s\S]+/</span><span class="pun">]]),[</span><span class="str">&#39;uq.val&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="pln">CPP_KEYWORDS</span><span class="pun">,</span><span class="str">&#39;hashComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;cStyleComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;types&#39;</span><span class="pun">:</span><span class="pln">C_TYPES</span><span class="pun">}),[</span><span class="str">&#39;c&#39;</span><span class="pun">,</span><span class="str">&#39;cc&#39;</span><span class="pun">,</span><span class="str">&#39;cpp&#39;</span><span class="pun">,</span><span class="str">&#39;cxx&#39;</span><span class="pun">,</span><span class="str">&#39;cyc&#39;</span><span class="pun">,</span><span class="str">&#39;m&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="str">&#39;null,true,false&#39;</span><span class="pun">}),[</span><span class="str">&#39;json&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="pln">CSHARP_KEYWORDS</span><span class="pun">,</span><span class="str">&#39;hashComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;cStyleComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;verbatimStrings&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;types&#39;</span><span class="pun">:</span><span class="pln">C_TYPES</span><span class="pun">}),[</span><span class="str">&#39;cs&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="pln">JAVA_KEYWORDS</span><span class="pun">,</span><span class="str">&#39;cStyleComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">}),[</span><span class="str">&#39;java&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="pln">SH_KEYWORDS</span><span class="pun">,</span><span class="str">&#39;hashComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;multiLineStrings&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">}),[</span><span class="str">&#39;bsh&#39;</span><span class="pun">,</span><span class="str">&#39;csh&#39;</span><span class="pun">,</span><span class="str">&#39;sh&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="pln">PYTHON_KEYWORDS</span><span class="pun">,</span><span class="str">&#39;hashComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;multiLineStrings&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;tripleQuotedStrings&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">}),[</span><span class="str">&#39;cv&#39;</span><span class="pun">,</span><span class="str">&#39;py&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="pln">PERL_KEYWORDS</span><span class="pun">,</span><span class="str">&#39;hashComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;multiLineStrings&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;regexLiterals&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">}),[</span><span class="str">&#39;perl&#39;</span><span class="pun">,</span><span class="str">&#39;pl&#39;</span><span class="pun">,</span><span class="str">&#39;pm&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="pln">RUBY_KEYWORDS</span><span class="pun">,</span><span class="str">&#39;hashComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;multiLineStrings&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;regexLiterals&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">}),[</span><span class="str">&#39;rb&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="pln">JSCRIPT_KEYWORDS</span><span class="pun">,</span><span class="str">&#39;cStyleComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;regexLiterals&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">}),[</span><span class="str">&#39;js&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">sourceDecorator</span><span class="pun">({</span><span class="str">&#39;keywords&#39;</span><span class="pun">:</span><span class="pln">COFFEE_KEYWORDS</span><span class="pun">,</span><span class="str">&#39;hashComments&#39;</span><span class="pun">:</span><span class="lit">3</span><span class="pun">,</span><span class="str">&#39;cStyleComments&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;multilineStrings&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;tripleQuotedStrings&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">,</span><span class="str">&#39;regexLiterals&#39;</span><span class="pun">:</span><span class="kwd">true</span><span class="pun">}),[</span><span class="str">&#39;coffee&#39;</span><span class="pun">]);</span><span class="pln">registerLangHandler</span><span class="pun">(</span><span class="pln">createSimpleLexer</span><span class="pun">([],[[</span><span class="pln">PR_STRING</span><span class="pun">,</span><span class="str">/^[\s\S]+/</span><span class="pun">]]),[</span><span class="str">&#39;regex&#39;</span><span class="pun">]);</span><span class="kwd">function</span><span class="pln"> applyDecorator</span><span class="pun">(</span><span class="pln">job</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> opt_langExtension</span><span class="pun">=</span><span class="pln">job</span><span class="pun">.</span><span class="pln">langExtension</span><span class="pun">;</span><span class="kwd">try</span><span class="pun">{</span><span class="kwd">var</span><span class="pln"> sourceAndSpans</span><span class="pun">=</span><span class="pln">extractSourceSpans</span><span class="pun">(</span><span class="pln">job</span><span class="pun">.</span><span class="pln">sourceNode</span><span class="pun">,</span><span class="pln">job</span><span class="pun">.</span><span class="pln">pre</span><span class="pun">);</span><span class="kwd">var</span><span class="pln"> source</span><span class="pun">=</span><span class="pln">sourceAndSpans</span><span class="pun">.</span><span class="pln">sourceCode</span><span class="pun">;</span><span class="pln">job</span><span class="pun">.</span><span class="pln">sourceCode</span><span class="pun">=</span><span class="pln">source</span><span class="pun">;</span><span class="pln">job</span><span class="pun">.</span><span class="pln">spans</span><span class="pun">=</span><span class="pln">sourceAndSpans</span><span class="pun">.</span><span class="pln">spans</span><span class="pun">;</span><span class="pln">job</span><span class="pun">.</span><span class="pln">basePos</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">langHandlerForExtension</span><span class="pun">(</span><span class="pln">opt_langExtension</span><span class="pun">,</span><span class="pln">source</span><span class="pun">)(</span><span class="pln">job</span><span class="pun">);</span><span class="pln">recombineTagsAndDecorations</span><span class="pun">(</span><span class="pln">job</span><span class="pun">);}</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">e</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">win</span><span class="pun">[</span><span class="str">&#39;console&#39;</span><span class="pun">]){</span><span class="pln">console</span><span class="pun">[</span><span class="str">&#39;log&#39;</span><span class="pun">](</span><span class="pln">e</span><span class="pun">&amp;&amp;</span><span class="pln">e</span><span class="pun">[</span><span class="str">&#39;stack&#39;</span><span class="pun">]?</span><span class="pln">e</span><span class="pun">[</span><span class="str">&#39;stack&#39;</span><span class="pun">]:</span><span class="pln">e</span><span class="pun">);}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="296"></td><td class="FileContents-lineContents" id="296"><span class="kwd">function</span><span class="pln"> prettyPrintOne</span><span class="pun">(</span><span class="pln">sourceCodeHtml</span><span class="pun">,</span><span class="pln">opt_langExtension</span><span class="pun">,</span><span class="pln">opt_numberLines</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> container</span><span class="pun">=</span><span class="pln">document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">&#39;pre&#39;</span><span class="pun">);</span><span class="pln">container</span><span class="pun">.</span><span class="pln">innerHTML</span><span class="pun">=</span><span class="pln">sourceCodeHtml</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">opt_numberLines</span><span class="pun">){</span><span class="pln">numberLines</span><span class="pun">(</span><span class="pln">container</span><span class="pun">,</span><span class="pln">opt_numberLines</span><span class="pun">,</span><span class="kwd">true</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="297"></td><td class="FileContents-lineContents" id="297"><span class="kwd">var</span><span class="pln"> job</span><span class="pun">={</span><span class="pln">langExtension</span><span class="pun">:</span><span class="pln">opt_langExtension</span><span class="pun">,</span><span class="pln">numberLines</span><span class="pun">:</span><span class="pln">opt_numberLines</span><span class="pun">,</span><span class="pln">sourceNode</span><span class="pun">:</span><span class="pln">container</span><span class="pun">,</span><span class="pln">pre</span><span class="pun">:</span><span class="lit">1</span><span class="pun">};</span><span class="pln">applyDecorator</span><span class="pun">(</span><span class="pln">job</span><span class="pun">);</span><span class="kwd">return</span><span class="pln"> container</span><span class="pun">.</span><span class="pln">innerHTML</span><span class="pun">;}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="298"></td><td class="FileContents-lineContents" id="298"><span class="kwd">function</span><span class="pln"> prettyPrint</span><span class="pun">(</span><span class="pln">opt_whenDone</span><span class="pun">){</span><span class="kwd">function</span><span class="pln"> byTagName</span><span class="pun">(</span><span class="pln">tn</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="pln">tn</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="299"></td><td class="FileContents-lineContents" id="299"><span class="kwd">var</span><span class="pln"> codeSegments</span><span class="pun">=[</span><span class="pln">byTagName</span><span class="pun">(</span><span class="str">&#39;pre&#39;</span><span class="pun">),</span><span class="pln">byTagName</span><span class="pun">(</span><span class="str">&#39;code&#39;</span><span class="pun">),</span><span class="pln">byTagName</span><span class="pun">(</span><span class="str">&#39;xmp&#39;</span><span class="pun">)];</span><span class="kwd">var</span><span class="pln"> elements</span><span class="pun">=[];</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">codeSegments</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">=</span><span class="pln">codeSegments</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">length</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">){</span><span class="pln">elements</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">codeSegments</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]);}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="300"></td><td class="FileContents-lineContents" id="300"><span class="pln">codeSegments</span><span class="pun">=</span><span class="kwd">null</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> clock</span><span class="pun">=</span><span class="typ">Date</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">clock</span><span class="pun">[</span><span class="str">&#39;now&#39;</span><span class="pun">]){</span><span class="pln">clock</span><span class="pun">={</span><span class="str">&#39;now&#39;</span><span class="pun">:</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">return</span><span class="pun">+(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Date</span><span class="pun">);}};}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="301"></td><td class="FileContents-lineContents" id="301"><span class="kwd">var</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> prettyPrintingJob</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> langExtensionRe</span><span class="pun">=</span><span class="str">/\blang(?:uage)?-([\w.]+)(?!\S)/</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> prettyPrintRe</span><span class="pun">=</span><span class="str">/\bprettyprint\b/</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> prettyPrintedRe</span><span class="pun">=</span><span class="str">/\bprettyprinted\b/</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> preformattedTagNameRe</span><span class="pun">=</span><span class="str">/pre|xmp/</span><span class="pln">i</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> codeRe</span><span class="pun">=</span><span class="str">/^code$/</span><span class="pln">i</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> preCodeXmpRe</span><span class="pun">=</span><span class="str">/^(?:pre|code|xmp)$/</span><span class="pln">i</span><span class="pun">;</span><span class="kwd">function</span><span class="pln"> doWork</span><span class="pun">(){</span><span class="kwd">var</span><span class="pln"> endTime</span><span class="pun">=(</span><span class="pln">win</span><span class="pun">[</span><span class="str">&#39;PR_SHOULD_USE_CONTINUATION&#39;</span><span class="pun">]?</span><span class="pln">clock</span><span class="pun">[</span><span class="str">&#39;now&#39;</span><span class="pun">]()+</span><span class="lit">250</span><span class="pun">:</span><span class="kwd">Infinity</span><span class="pun">);</span><span class="kwd">for</span><span class="pun">(;</span><span class="pln">k</span><span class="pun">&lt;</span><span class="pln">elements</span><span class="pun">.</span><span class="pln">length</span><span class="pun">&amp;&amp;</span><span class="pln">clock</span><span class="pun">[</span><span class="str">&#39;now&#39;</span><span class="pun">]()&lt;</span><span class="pln">endTime</span><span class="pun">;</span><span class="pln">k</span><span class="pun">++){</span><span class="kwd">var</span><span class="pln"> cs</span><span class="pun">=</span><span class="pln">elements</span><span class="pun">[</span><span class="pln">k</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> className</span><span class="pun">=</span><span class="pln">cs</span><span class="pun">.</span><span class="pln">className</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">prettyPrintRe</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">className</span><span class="pun">)&amp;&amp;!</span><span class="pln">prettyPrintedRe</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">className</span><span class="pun">)){</span><span class="kwd">var</span><span class="pln"> nested</span><span class="pun">=</span><span class="kwd">false</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> p</span><span class="pun">=</span><span class="pln">cs</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">;</span><span class="pln">p</span><span class="pun">;</span><span class="pln">p</span><span class="pun">=</span><span class="pln">p</span><span class="pun">.</span><span class="pln">parentNode</span><span class="pun">){</span><span class="kwd">var</span><span class="pln"> tn</span><span class="pun">=</span><span class="pln">p</span><span class="pun">.</span><span class="pln">tagName</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">preCodeXmpRe</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">tn</span><span class="pun">)&amp;&amp;</span><span class="pln">p</span><span class="pun">.</span><span class="pln">className</span><span class="pun">&amp;&amp;</span><span class="pln">prettyPrintRe</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">className</span><span class="pun">)){</span><span class="pln">nested</span><span class="pun">=</span><span class="kwd">true</span><span class="pun">;</span><span class="kwd">break</span><span class="pun">;}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="302"></td><td class="FileContents-lineContents" id="302"><span class="kwd">if</span><span class="pun">(!</span><span class="pln">nested</span><span class="pun">){</span><span class="pln">cs</span><span class="pun">.</span><span class="pln">className</span><span class="pun">+=</span><span class="str">&#39; prettyprinted&#39;</span><span class="pun">;</span><span class="kwd">var</span><span class="pln"> langExtension</span><span class="pun">=</span><span class="pln">className</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">langExtensionRe</span><span class="pun">);</span><span class="kwd">var</span><span class="pln"> wrapper</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">langExtension</span><span class="pun">&amp;&amp;(</span><span class="pln">wrapper</span><span class="pun">=</span><span class="pln">childContentWrapper</span><span class="pun">(</span><span class="pln">cs</span><span class="pun">))&amp;&amp;</span><span class="pln">codeRe</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">wrapper</span><span class="pun">.</span><span class="pln">tagName</span><span class="pun">)){</span><span class="pln">langExtension</span><span class="pun">=</span><span class="pln">wrapper</span><span class="pun">.</span><span class="pln">className</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="pln">langExtensionRe</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="303"></td><td class="FileContents-lineContents" id="303"><span class="kwd">if</span><span class="pun">(</span><span class="pln">langExtension</span><span class="pun">){</span><span class="pln">langExtension</span><span class="pun">=</span><span class="pln">langExtension</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="304"></td><td class="FileContents-lineContents" id="304"><span class="kwd">var</span><span class="pln"> preformatted</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">preformattedTagNameRe</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">cs</span><span class="pun">.</span><span class="pln">tagName</span><span class="pun">)){</span><span class="pln">preformatted</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;}</span><span class="kwd">else</span><span class="pun">{</span><span class="kwd">var</span><span class="pln"> currentStyle</span><span class="pun">=</span><span class="pln">cs</span><span class="pun">[</span><span class="str">&#39;currentStyle&#39;</span><span class="pun">];</span><span class="kwd">var</span><span class="pln"> whitespace</span><span class="pun">=(</span><span class="pln">currentStyle</span><span class="pun">?</span><span class="pln">currentStyle</span><span class="pun">[</span><span class="str">&#39;whiteSpace&#39;</span><span class="pun">]:(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">defaultView</span><span class="pun">&amp;&amp;</span><span class="pln">document</span><span class="pun">.</span><span class="pln">defaultView</span><span class="pun">.</span><span class="pln">getComputedStyle</span><span class="pun">)?</span><span class="pln">document</span><span class="pun">.</span><span class="pln">defaultView</span><span class="pun">.</span><span class="pln">getComputedStyle</span><span class="pun">(</span><span class="pln">cs</span><span class="pun">,</span><span class="kwd">null</span><span class="pun">).</span><span class="pln">getPropertyValue</span><span class="pun">(</span><span class="str">&#39;white-space&#39;</span><span class="pun">):</span><span class="lit">0</span><span class="pun">);</span><span class="pln">preformatted</span><span class="pun">=</span><span class="pln">whitespace</span><span class="pun">&amp;&amp;</span><span class="str">&#39;pre&#39;</span><span class="pun">===</span><span class="pln">whitespace</span><span class="pun">.</span><span class="pln">substring</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="lit">3</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="305"></td><td class="FileContents-lineContents" id="305"><span class="kwd">var</span><span class="pln"> lineNums</span><span class="pun">=</span><span class="pln">cs</span><span class="pun">.</span><span class="pln">className</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="str">/\blinenums\b(?::(\d+))?/</span><span class="pun">);</span><span class="pln">lineNums</span><span class="pun">=</span><span class="pln">lineNums</span><span class="pun">?</span><span class="pln">lineNums</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]&amp;&amp;</span><span class="pln">lineNums</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">length</span><span class="pun">?+</span><span class="pln">lineNums</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]:</span><span class="kwd">true</span><span class="pun">:</span><span class="kwd">false</span><span class="pun">;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">lineNums</span><span class="pun">){</span><span class="pln">numberLines</span><span class="pun">(</span><span class="pln">cs</span><span class="pun">,</span><span class="pln">lineNums</span><span class="pun">,</span><span class="pln">preformatted</span><span class="pun">);}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="306"></td><td class="FileContents-lineContents" id="306"><span class="pln">prettyPrintingJob</span><span class="pun">={</span><span class="pln">langExtension</span><span class="pun">:</span><span class="pln">langExtension</span><span class="pun">,</span><span class="pln">sourceNode</span><span class="pun">:</span><span class="pln">cs</span><span class="pun">,</span><span class="pln">numberLines</span><span class="pun">:</span><span class="pln">lineNums</span><span class="pun">,</span><span class="pln">pre</span><span class="pun">:</span><span class="pln">preformatted</span><span class="pun">};</span><span class="pln">applyDecorator</span><span class="pun">(</span><span class="pln">prettyPrintingJob</span><span class="pun">);}}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="307"></td><td class="FileContents-lineContents" id="307"><span class="kwd">if</span><span class="pun">(</span><span class="pln">k</span><span class="pun">&lt;</span><span class="pln">elements</span><span class="pun">.</span><span class="pln">length</span><span class="pun">){</span><span class="pln">setTimeout</span><span class="pun">(</span><span class="pln">doWork</span><span class="pun">,</span><span class="lit">250</span><span class="pun">);}</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">opt_whenDone</span><span class="pun">){</span><span class="pln">opt_whenDone</span><span class="pun">();}}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="308"></td><td class="FileContents-lineContents" id="308"><span class="pln">doWork</span><span class="pun">();}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="309"></td><td class="FileContents-lineContents" id="309"><span class="kwd">var</span><span class="pln"> PR</span><span class="pun">=</span><span class="pln">win</span><span class="pun">[</span><span class="str">&#39;PR&#39;</span><span class="pun">]={</span><span class="str">&#39;createSimpleLexer&#39;</span><span class="pun">:</span><span class="pln">createSimpleLexer</span><span class="pun">,</span><span class="str">&#39;registerLangHandler&#39;</span><span class="pun">:</span><span class="pln">registerLangHandler</span><span class="pun">,</span><span class="str">&#39;sourceDecorator&#39;</span><span class="pun">:</span><span class="pln">sourceDecorator</span><span class="pun">,</span><span class="str">&#39;PR_ATTRIB_NAME&#39;</span><span class="pun">:</span><span class="pln">PR_ATTRIB_NAME</span><span class="pun">,</span><span class="str">&#39;PR_ATTRIB_VALUE&#39;</span><span class="pun">:</span><span class="pln">PR_ATTRIB_VALUE</span><span class="pun">,</span><span class="str">&#39;PR_COMMENT&#39;</span><span class="pun">:</span><span class="pln">PR_COMMENT</span><span class="pun">,</span><span class="str">&#39;PR_DECLARATION&#39;</span><span class="pun">:</span><span class="pln">PR_DECLARATION</span><span class="pun">,</span><span class="str">&#39;PR_KEYWORD&#39;</span><span class="pun">:</span><span class="pln">PR_KEYWORD</span><span class="pun">,</span><span class="str">&#39;PR_LITERAL&#39;</span><span class="pun">:</span><span class="pln">PR_LITERAL</span><span class="pun">,</span><span class="str">&#39;PR_NOCODE&#39;</span><span class="pun">:</span><span class="pln">PR_NOCODE</span><span class="pun">,</span><span class="str">&#39;PR_PLAIN&#39;</span><span class="pun">:</span><span class="pln">PR_PLAIN</span><span class="pun">,</span><span class="str">&#39;PR_PUNCTUATION&#39;</span><span class="pun">:</span><span class="pln">PR_PUNCTUATION</span><span class="pun">,</span><span class="str">&#39;PR_SOURCE&#39;</span><span class="pun">:</span><span class="pln">PR_SOURCE</span><span class="pun">,</span><span class="str">&#39;PR_STRING&#39;</span><span class="pun">:</span><span class="pln">PR_STRING</span><span class="pun">,</span><span class="str">&#39;PR_TAG&#39;</span><span class="pun">:</span><span class="pln">PR_TAG</span><span class="pun">,</span><span class="str">&#39;PR_TYPE&#39;</span><span class="pun">:</span><span class="pln">PR_TYPE</span><span class="pun">,</span><span class="str">&#39;prettyPrintOne&#39;</span><span class="pun">:</span><span class="pln">win</span><span class="pun">[</span><span class="str">&#39;prettyPrintOne&#39;</span><span class="pun">]=</span><span class="pln">prettyPrintOne</span><span class="pun">,</span><span class="str">&#39;prettyPrint&#39;</span><span class="pun">:</span><span class="pln">win</span><span class="pun">[</span><span class="str">&#39;prettyPrint&#39;</span><span class="pun">]=</span><span class="pln">prettyPrint</span><span class="pun">};</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">typeof</span><span class="pln"> define</span><span class="pun">===</span><span class="str">&quot;function&quot;</span><span class="pun">&amp;&amp;</span><span class="pln">define</span><span class="pun">[</span><span class="str">&#39;amd&#39;</span><span class="pun">]){</span><span class="pln">define</span><span class="pun">(</span><span class="str">&quot;google-code-prettify&quot;</span><span class="pun">,[],</span><span class="kwd">function</span><span class="pun">(){</span><span class="kwd">return</span><span class="pln"> PR</span><span class="pun">;});}})();</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="310"></td><td class="FileContents-lineContents" id="310"><span class="pun">;(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">window</span><span class="pun">,</span><span class="pln"> document</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="311"></td><td class="FileContents-lineContents" id="311"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="312"></td><td class="FileContents-lineContents" id="312"><span class="pln">  </span><span class="com">// Hide body until we&#39;re done fiddling with the DOM</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="313"></td><td class="FileContents-lineContents" id="313"><span class="pln">  document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">display </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;none&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="314"></td><td class="FileContents-lineContents" id="314"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="315"></td><td class="FileContents-lineContents" id="315"><span class="pln">  </span><span class="com">//////////////////////////////////////////////////////////////////////</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="316"></td><td class="FileContents-lineContents" id="316"><span class="pln">  </span><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="317"></td><td class="FileContents-lineContents" id="317"><span class="pln">  </span><span class="com">// Shims for IE &lt; 9</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="318"></td><td class="FileContents-lineContents" id="318"><span class="pln">  </span><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="319"></td><td class="FileContents-lineContents" id="319"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="320"></td><td class="FileContents-lineContents" id="320"><span class="pln">  document</span><span class="pun">.</span><span class="pln">head </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">&#39;head&#39;</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">];</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="321"></td><td class="FileContents-lineContents" id="321"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="322"></td><td class="FileContents-lineContents" id="322"><span class="pln">  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!(</span><span class="str">&#39;getElementsByClassName&#39;</span><span class="pln"> in document</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="323"></td><td class="FileContents-lineContents" id="323"><span class="pln">    document</span><span class="pun">.</span><span class="pln">getElementsByClassName </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="324"></td><td class="FileContents-lineContents" id="324"><span class="pln">      </span><span class="kwd">function</span><span class="pln"> getElementsByClassName</span><span class="pun">(</span><span class="pln">node</span><span class="pun">,</span><span class="pln"> classname</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="325"></td><td class="FileContents-lineContents" id="325"><span class="pln">        </span><span class="kwd">var</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="326"></td><td class="FileContents-lineContents" id="326"><span class="pln">        </span><span class="kwd">var</span><span class="pln"> re </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RegExp</span><span class="pun">(</span><span class="str">&#39;(^| )&#39;</span><span class="pun">+</span><span class="pln">classname</span><span class="pun">+</span><span class="str">&#39;( |$)&#39;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="327"></td><td class="FileContents-lineContents" id="327"><span class="pln">        </span><span class="kwd">var</span><span class="pln"> els </span><span class="pun">=</span><span class="pln"> node</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">&quot;*&quot;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="328"></td><td class="FileContents-lineContents" id="328"><span class="pln">        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">j</span><span class="pun">=</span><span class="pln">els</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">j</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="329"></td><td class="FileContents-lineContents" id="329"><span class="pln">            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">re</span><span class="pun">.</span><span class="pln">test</span><span class="pun">(</span><span class="pln">els</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">className</span><span class="pun">))</span><span class="pln">a</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">els</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="330"></td><td class="FileContents-lineContents" id="330"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="331"></td><td class="FileContents-lineContents" id="331"><span class="pln">      </span><span class="pun">}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="332"></td><td class="FileContents-lineContents" id="332"><span class="pln">      </span><span class="kwd">return</span><span class="pln"> getElementsByClassName</span><span class="pun">(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">,</span><span class="pln"> name</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="333"></td><td class="FileContents-lineContents" id="333"><span class="pln">    </span><span class="pun">}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="334"></td><td class="FileContents-lineContents" id="334"><span class="pln">  </span><span class="pun">}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="335"></td><td class="FileContents-lineContents" id="335"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="336"></td><td class="FileContents-lineContents" id="336"><span class="pln">  </span><span class="com">//////////////////////////////////////////////////////////////////////</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="337"></td><td class="FileContents-lineContents" id="337"><span class="pln">  </span><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="338"></td><td class="FileContents-lineContents" id="338"><span class="pln">  </span><span class="com">// Get user elements we need</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="339"></td><td class="FileContents-lineContents" id="339"><span class="pln">  </span><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="340"></td><td class="FileContents-lineContents" id="340"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="341"></td><td class="FileContents-lineContents" id="341"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> markdownEl </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">&#39;xmp&#39;</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">&#39;textarea&#39;</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="342"></td><td class="FileContents-lineContents" id="342"><span class="pln">      titleEl </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">&#39;title&#39;</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">],</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="343"></td><td class="FileContents-lineContents" id="343"><span class="pln">      scriptEls </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">&#39;script&#39;</span><span class="pun">),</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="344"></td><td class="FileContents-lineContents" id="344"><span class="pln">      navbarEl </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByClassName</span><span class="pun">(</span><span class="str">&#39;navbar&#39;</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">];</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="345"></td><td class="FileContents-lineContents" id="345"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="346"></td><td class="FileContents-lineContents" id="346"><span class="pln">  </span><span class="com">//////////////////////////////////////////////////////////////////////</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="347"></td><td class="FileContents-lineContents" id="347"><span class="pln">  </span><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="348"></td><td class="FileContents-lineContents" id="348"><span class="pln">  </span><span class="com">// &lt;head&gt; stuff</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="349"></td><td class="FileContents-lineContents" id="349"><span class="pln">  </span><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="350"></td><td class="FileContents-lineContents" id="350"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="351"></td><td class="FileContents-lineContents" id="351"><span class="pln">  </span><span class="com">// Use &lt;meta&gt; viewport so that Bootstrap is actually responsive on mobile</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="352"></td><td class="FileContents-lineContents" id="352"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> metaEl </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">&#39;meta&#39;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="353"></td><td class="FileContents-lineContents" id="353"><span class="pln">  metaEl</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;viewport&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="354"></td><td class="FileContents-lineContents" id="354"><span class="pln">  metaEl</span><span class="pun">.</span><span class="pln">content </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="355"></td><td class="FileContents-lineContents" id="355"><span class="pln">  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">head</span><span class="pun">.</span><span class="pln">firstChild</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="356"></td><td class="FileContents-lineContents" id="356"><span class="pln">    document</span><span class="pun">.</span><span class="pln">head</span><span class="pun">.</span><span class="pln">insertBefore</span><span class="pun">(</span><span class="pln">metaEl</span><span class="pun">,</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">head</span><span class="pun">.</span><span class="pln">firstChild</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="357"></td><td class="FileContents-lineContents" id="357"><span class="pln">  </span><span class="kwd">else</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="358"></td><td class="FileContents-lineContents" id="358"><span class="pln">    document</span><span class="pun">.</span><span class="pln">head</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">metaEl</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="359"></td><td class="FileContents-lineContents" id="359"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="360"></td><td class="FileContents-lineContents" id="360"><span class="pln">  </span><span class="com">// Get origin of script</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="361"></td><td class="FileContents-lineContents" id="361"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> origin </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="362"></td><td class="FileContents-lineContents" id="362"><span class="pln">  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> scriptEls</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="363"></td><td class="FileContents-lineContents" id="363"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">scriptEls</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">src</span><span class="pun">.</span><span class="pln">match</span><span class="pun">(</span><span class="str">&#39;strapdown&#39;</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="364"></td><td class="FileContents-lineContents" id="364"><span class="pln">      origin </span><span class="pun">=</span><span class="pln"> scriptEls</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">src</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="365"></td><td class="FileContents-lineContents" id="365"><span class="pln">    </span><span class="pun">}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="366"></td><td class="FileContents-lineContents" id="366"><span class="pln">  </span><span class="pun">}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="367"></td><td class="FileContents-lineContents" id="367"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> originBase </span><span class="pun">=</span><span class="pln"> origin</span><span class="pun">.</span><span class="pln">substr</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> origin</span><span class="pun">.</span><span class="pln">lastIndexOf</span><span class="pun">(</span><span class="str">&#39;/&#39;</span><span class="pun">));</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="368"></td><td class="FileContents-lineContents" id="368"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="369"></td><td class="FileContents-lineContents" id="369"><span class="pln">  </span><span class="com">// Get theme</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="370"></td><td class="FileContents-lineContents" id="370"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> theme </span><span class="pun">=</span><span class="pln"> markdownEl</span><span class="pun">.</span><span class="pln">getAttribute</span><span class="pun">(</span><span class="str">&#39;theme&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="str">&#39;bootstrap&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="371"></td><td class="FileContents-lineContents" id="371"><span class="pln">  theme </span><span class="pun">=</span><span class="pln"> theme</span><span class="pun">.</span><span class="pln">toLowerCase</span><span class="pun">();</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="372"></td><td class="FileContents-lineContents" id="372"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="373"></td><td class="FileContents-lineContents" id="373"><span class="pln">  </span><span class="com">// Stylesheets</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="374"></td><td class="FileContents-lineContents" id="374"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> linkEl </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">&#39;link&#39;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="375"></td><td class="FileContents-lineContents" id="375"><span class="pln">  linkEl</span><span class="pun">.</span><span class="pln">href </span><span class="pun">=</span><span class="pln"> originBase </span><span class="pun">+</span><span class="pln"> </span><span class="str">&#39;/themes/&#39;</span><span class="pun">+</span><span class="pln">theme</span><span class="pun">+</span><span class="str">&#39;.min.css&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="376"></td><td class="FileContents-lineContents" id="376"><span class="pln">  linkEl</span><span class="pun">.</span><span class="pln">rel </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;stylesheet&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="377"></td><td class="FileContents-lineContents" id="377"><span class="pln">  document</span><span class="pun">.</span><span class="pln">head</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">linkEl</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="378"></td><td class="FileContents-lineContents" id="378"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="379"></td><td class="FileContents-lineContents" id="379"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> linkEl </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">&#39;link&#39;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="380"></td><td class="FileContents-lineContents" id="380"><span class="pln">  linkEl</span><span class="pun">.</span><span class="pln">href </span><span class="pun">=</span><span class="pln"> originBase </span><span class="pun">+</span><span class="pln"> </span><span class="str">&#39;/strapdown.css&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="381"></td><td class="FileContents-lineContents" id="381"><span class="pln">  linkEl</span><span class="pun">.</span><span class="pln">rel </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;stylesheet&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="382"></td><td class="FileContents-lineContents" id="382"><span class="pln">  document</span><span class="pun">.</span><span class="pln">head</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">linkEl</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="383"></td><td class="FileContents-lineContents" id="383"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="384"></td><td class="FileContents-lineContents" id="384"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> linkEl </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">&#39;link&#39;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="385"></td><td class="FileContents-lineContents" id="385"><span class="pln">  linkEl</span><span class="pun">.</span><span class="pln">href </span><span class="pun">=</span><span class="pln"> originBase </span><span class="pun">+</span><span class="pln"> </span><span class="str">&#39;/themes/bootstrap-responsive.min.css&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="386"></td><td class="FileContents-lineContents" id="386"><span class="pln">  linkEl</span><span class="pun">.</span><span class="pln">rel </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;stylesheet&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="387"></td><td class="FileContents-lineContents" id="387"><span class="pln">  document</span><span class="pun">.</span><span class="pln">head</span><span class="pun">.</span><span class="pln">appendChild</span><span class="pun">(</span><span class="pln">linkEl</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="388"></td><td class="FileContents-lineContents" id="388"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="389"></td><td class="FileContents-lineContents" id="389"><span class="pln">  </span><span class="com">//////////////////////////////////////////////////////////////////////</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="390"></td><td class="FileContents-lineContents" id="390"><span class="pln">  </span><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="391"></td><td class="FileContents-lineContents" id="391"><span class="pln">  </span><span class="com">// &lt;body&gt; stuff</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="392"></td><td class="FileContents-lineContents" id="392"><span class="pln">  </span><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="393"></td><td class="FileContents-lineContents" id="393"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="394"></td><td class="FileContents-lineContents" id="394"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> markdown </span><span class="pun">=</span><span class="pln"> markdownEl</span><span class="pun">.</span><span class="pln">textContent </span><span class="pun">||</span><span class="pln"> markdownEl</span><span class="pun">.</span><span class="pln">innerText</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="395"></td><td class="FileContents-lineContents" id="395"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="396"></td><td class="FileContents-lineContents" id="396"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> newNode </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">&#39;div&#39;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="397"></td><td class="FileContents-lineContents" id="397"><span class="pln">  newNode</span><span class="pun">.</span><span class="pln">className </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;container&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="398"></td><td class="FileContents-lineContents" id="398"><span class="pln">  newNode</span><span class="pun">.</span><span class="pln">id </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;content&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="399"></td><td class="FileContents-lineContents" id="399"><span class="pln">  document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">replaceChild</span><span class="pun">(</span><span class="pln">newNode</span><span class="pun">,</span><span class="pln"> markdownEl</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="400"></td><td class="FileContents-lineContents" id="400"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="401"></td><td class="FileContents-lineContents" id="401"><span class="pln">  </span><span class="com">// Insert navbar if there&#39;s none</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="402"></td><td class="FileContents-lineContents" id="402"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> newNode </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">&#39;div&#39;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="403"></td><td class="FileContents-lineContents" id="403"><span class="pln">  newNode</span><span class="pun">.</span><span class="pln">className </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;navbar navbar-fixed-top&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="404"></td><td class="FileContents-lineContents" id="404"><span class="pln">  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">navbarEl </span><span class="pun">&amp;&amp;</span><span class="pln"> titleEl</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="405"></td><td class="FileContents-lineContents" id="405"><span class="pln">    newNode</span><span class="pun">.</span><span class="pln">innerHTML </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&lt;div class=&quot;navbar-inner&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;div id=&quot;headline&quot; class=&quot;brand&quot;&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="406"></td><td class="FileContents-lineContents" id="406"><span class="pln">    document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">insertBefore</span><span class="pun">(</span><span class="pln">newNode</span><span class="pun">,</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">firstChild</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="407"></td><td class="FileContents-lineContents" id="407"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> title </span><span class="pun">=</span><span class="pln"> titleEl</span><span class="pun">.</span><span class="pln">innerHTML</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="408"></td><td class="FileContents-lineContents" id="408"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> headlineEl </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">&#39;headline&#39;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="409"></td><td class="FileContents-lineContents" id="409"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">headlineEl</span><span class="pun">)</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="410"></td><td class="FileContents-lineContents" id="410"><span class="pln">      headlineEl</span><span class="pun">.</span><span class="pln">innerHTML </span><span class="pun">=</span><span class="pln"> title</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="411"></td><td class="FileContents-lineContents" id="411"><span class="pln">  </span><span class="pun">}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="412"></td><td class="FileContents-lineContents" id="412"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="413"></td><td class="FileContents-lineContents" id="413"><span class="pln">  </span><span class="com">//////////////////////////////////////////////////////////////////////</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="414"></td><td class="FileContents-lineContents" id="414"><span class="pln">  </span><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="415"></td><td class="FileContents-lineContents" id="415"><span class="pln">  </span><span class="com">// Markdown!</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="416"></td><td class="FileContents-lineContents" id="416"><span class="pln">  </span><span class="com">//</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="417"></td><td class="FileContents-lineContents" id="417"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="418"></td><td class="FileContents-lineContents" id="418"><span class="pln">  </span><span class="com">// Generate Markdown</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="419"></td><td class="FileContents-lineContents" id="419"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> html </span><span class="pun">=</span><span class="pln"> marked</span><span class="pun">(</span><span class="pln">markdown</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="420"></td><td class="FileContents-lineContents" id="420"><span class="pln">  document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">&#39;content&#39;</span><span class="pun">).</span><span class="pln">innerHTML </span><span class="pun">=</span><span class="pln"> html</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="421"></td><td class="FileContents-lineContents" id="421"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="422"></td><td class="FileContents-lineContents" id="422"><span class="pln">  </span><span class="com">// Prettify</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="423"></td><td class="FileContents-lineContents" id="423"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> codeEls </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">&#39;code&#39;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="424"></td><td class="FileContents-lineContents" id="424"><span class="pln">  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> ii</span><span class="pun">=</span><span class="pln">codeEls</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">ii</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="425"></td><td class="FileContents-lineContents" id="425"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> codeEl </span><span class="pun">=</span><span class="pln"> codeEls</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="426"></td><td class="FileContents-lineContents" id="426"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> lang </span><span class="pun">=</span><span class="pln"> codeEl</span><span class="pun">.</span><span class="pln">className</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="427"></td><td class="FileContents-lineContents" id="427"><span class="pln">    codeEl</span><span class="pun">.</span><span class="pln">className </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;prettyprint lang-&#39;</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> lang</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="428"></td><td class="FileContents-lineContents" id="428"><span class="pln">  </span><span class="pun">}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="429"></td><td class="FileContents-lineContents" id="429"><span class="pln">  prettyPrint</span><span class="pun">();</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="430"></td><td class="FileContents-lineContents" id="430"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="431"></td><td class="FileContents-lineContents" id="431"><span class="pln">  </span><span class="com">// Style tables</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="432"></td><td class="FileContents-lineContents" id="432"><span class="pln">  </span><span class="kwd">var</span><span class="pln"> tableEls </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementsByTagName</span><span class="pun">(</span><span class="str">&#39;table&#39;</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="433"></td><td class="FileContents-lineContents" id="433"><span class="pln">  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> ii</span><span class="pun">=</span><span class="pln">tableEls</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">ii</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="434"></td><td class="FileContents-lineContents" id="434"><span class="pln">    </span><span class="kwd">var</span><span class="pln"> tableEl </span><span class="pun">=</span><span class="pln"> tableEls</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="435"></td><td class="FileContents-lineContents" id="435"><span class="pln">    tableEl</span><span class="pun">.</span><span class="pln">className </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;table table-striped table-bordered&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="436"></td><td class="FileContents-lineContents" id="436"><span class="pln">  </span><span class="pun">}</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="437"></td><td class="FileContents-lineContents" id="437"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="438"></td><td class="FileContents-lineContents" id="438"><span class="pln">  </span><span class="com">// All done - show body</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="439"></td><td class="FileContents-lineContents" id="439"><span class="pln">  document</span><span class="pun">.</span><span class="pln">body</span><span class="pun">.</span><span class="pln">style</span><span class="pun">.</span><span class="pln">display </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="440"></td><td class="FileContents-lineContents" id="440"></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="441"></td><td class="FileContents-lineContents" id="441"><span class="pun">})(</span><span class="pln">window</span><span class="pun">,</span><span class="pln"> document</span><span class="pun">);</span></td></tr><tr class="u-pre u-monospace FileContents-line"><td class="u-lineNum u-noSelect FileContents-lineNum" data-line-number="442"></td><td class="FileContents-lineContents" id="442"></td></tr></table><script nonce="sEux87XSui40cRtxYoR-VA">for (let lineNumEl of document.querySelectorAll('td.u-lineNum')) {lineNumEl.onclick = () => {window.location.hash = `#${lineNumEl.getAttribute('data-line-number')}`;};}</script></div> <!-- Container --></div> <!-- Site-content --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a>| <a href="https://policies.google.com/terms">Terms</a></span><span class="Footer-formats"><a class="u-monospace Footer-formatsItem" href="?format=TEXT">txt</a> <a class="u-monospace Footer-formatsItem" href="?format=JSON">json</a></span></div></footer></body></html>